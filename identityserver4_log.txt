2019-06-26 19:44:17.252 +01:00 [FTL] Application startup exception
System.Exception: Could not resolve a service of type 'IdentityServer4AspNetIdentity.SeedData' for the parameter 'seedData' of method 'Configure' on type 'IdentityServer4AspNetIdentity.Startup'. ---> System.InvalidOperationException: No service for type 'IdentityServer4AspNetIdentity.SeedData' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.<>c__DisplayClass4_0.<Build>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-06-26 19:45:58.725 +01:00 [FTL] Application startup exception
System.Exception: Could not resolve a service of type 'IdentityServer4AspNetIdentity.SeedData' for the parameter 'seedData' of method 'Configure' on type 'IdentityServer4AspNetIdentity.Startup'. ---> System.InvalidOperationException: No service for type 'IdentityServer4AspNetIdentity.SeedData' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.<>c__DisplayClass4_0.<Build>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-06-26 20:00:52.119 +01:00 [FTL] Application startup exception
System.Exception: Could not resolve a service of type 'IdentityServer4AspNetIdentity.SeedData' for the parameter 'seedData' of method 'Configure' on type 'IdentityServer4AspNetIdentity.Startup'. ---> System.InvalidOperationException: Cannot consume scoped service 'Microsoft.AspNetCore.Identity.UserManager`1[IdentityServer4AspNetIdentity.Models.ApplicationUser]' from singleton 'IdentityServer4AspNetIdentity.SeedData'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.VisitScoped(ScopedCallSite scopedCallSite, CallSiteValidatorState state)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(IServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.VisitConstructor(ConstructorCallSite constructorCallSite, CallSiteValidatorState state)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(IServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.VisitSingleton(SingletonCallSite singletonCallSite, CallSiteValidatorState state)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(IServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateCallSite(IServiceCallSite callSite)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.Microsoft.Extensions.DependencyInjection.ServiceLookup.IServiceProviderEngineCallback.OnCreate(IServiceCallSite callSite)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.CreateServiceAccessor(Type serviceType)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.Invoke(Object instance, IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.ConfigureBuilder.<>c__DisplayClass4_0.<Build>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-06-26 20:03:17.235 +01:00 [ERR] Failed executing DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[JobTitle], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Nickname], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'JobTitle'.
Invalid column name 'Nickname'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:959332d3-0e6d-4347-b111-992344f1d642
Error Number:207,State:1,Class:16
2019-06-26 20:03:17.334 +01:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4AspNetIdentity.Data.AuthServerApplicationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'JobTitle'.
Invalid column name 'Nickname'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:959332d3-0e6d-4347-b111-992344f1d642
Error Number:207,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid column name 'JobTitle'.
Invalid column name 'Nickname'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:959332d3-0e6d-4347-b111-992344f1d642
Error Number:207,State:1,Class:16
2019-06-26 20:28:17.484 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-26 20:28:17.636 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-26 20:28:17.671 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-26 20:28:17.678 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-26 20:28:17.701 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-26 20:28:17.703 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-26 20:28:18.277 +01:00 [DBG] Starting grant removal
2019-06-26 20:28:21.373 +01:00 [DBG] Login Url: /Account/Login
2019-06-26 20:28:21.385 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-26 20:28:21.394 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-26 20:28:21.395 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-26 20:28:21.405 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-26 20:28:21.422 +01:00 [DBG] Error Url: /home/error
2019-06-26 20:28:21.432 +01:00 [DBG] Error Id Parameter: errorId
2019-06-26 20:28:38.848 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-26 20:28:38.872 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-26 20:28:38.879 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-26 20:28:38.918 +01:00 [DBG] Start discovery request
2019-06-26 20:28:48.343 +01:00 [INF] Removing 0 grants
2019-06-26 20:29:18.370 +01:00 [INF] Removing 0 grants
2019-06-26 20:29:46.987 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-26 20:29:48.884 +01:00 [INF] Removing 0 grants
2019-06-26 22:33:24.741 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-26 22:33:24.818 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-26 22:33:24.830 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-26 22:33:24.832 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-26 22:33:24.833 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-26 22:33:24.833 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-26 22:33:25.240 +01:00 [DBG] Starting grant removal
2019-06-26 22:33:27.723 +01:00 [DBG] Login Url: /Account/Login
2019-06-26 22:33:27.747 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-26 22:33:27.748 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-26 22:33:27.833 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-26 22:33:27.901 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-26 22:33:27.953 +01:00 [DBG] Error Url: /home/error
2019-06-26 22:33:27.959 +01:00 [DBG] Error Id Parameter: errorId
2019-06-26 22:33:36.517 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-26 22:33:36.547 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-26 22:33:36.570 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-26 22:33:36.623 +01:00 [DBG] Start discovery request
2019-06-26 22:33:55.461 +01:00 [INF] Removing 0 grants
2019-06-26 22:34:25.478 +01:00 [INF] Removing 0 grants
2019-06-26 22:34:55.483 +01:00 [INF] Removing 0 grants
2019-06-26 22:35:25.514 +01:00 [INF] Removing 0 grants
2019-06-26 22:35:55.535 +01:00 [INF] Removing 0 grants
2019-06-26 22:36:25.551 +01:00 [INF] Removing 0 grants
2019-06-26 22:36:55.556 +01:00 [INF] Removing 0 grants
2019-06-26 22:37:25.566 +01:00 [INF] Removing 0 grants
2019-06-26 22:37:55.569 +01:00 [INF] Removing 0 grants
2019-06-26 22:38:25.743 +01:00 [INF] Removing 0 grants
2019-06-27 00:38:17.074 +01:00 [INF] Removing 0 grants
2019-06-27 00:38:48.922 +01:00 [INF] Removing 0 grants
2019-06-27 00:59:21.476 +01:00 [INF] Removing 0 grants
2019-06-27 00:59:51.495 +01:00 [INF] Removing 0 grants
2019-06-27 03:04:27.240 +01:00 [INF] Removing 0 grants
2019-06-27 03:04:58.291 +01:00 [INF] Removing 0 grants
2019-06-27 03:51:39.861 +01:00 [INF] Removing 0 grants
2019-06-27 03:52:09.877 +01:00 [INF] Removing 0 grants
2019-06-27 05:10:35.919 +01:00 [INF] Removing 0 grants
2019-06-27 05:11:06.433 +01:00 [INF] Removing 0 grants
2019-06-27 08:18:06.268 +01:00 [INF] Removing 0 grants
2019-06-27 08:18:36.349 +01:00 [INF] Removing 0 grants
2019-06-27 08:28:03.064 +01:00 [INF] Removing 0 grants
2019-06-27 08:28:34.506 +01:00 [INF] Removing 0 grants
2019-06-27 08:46:48.717 +01:00 [INF] Removing 0 grants
2019-06-27 08:47:23.283 +01:00 [INF] Removing 0 grants
2019-06-27 09:00:57.054 +01:00 [INF] Removing 0 grants
2019-06-27 09:01:27.108 +01:00 [INF] Removing 0 grants
2019-06-27 09:19:46.353 +01:00 [INF] Removing 0 grants
2019-06-27 09:20:16.390 +01:00 [INF] Removing 0 grants
2019-06-27 09:38:28.431 +01:00 [INF] Removing 0 grants
2019-06-27 09:38:58.445 +01:00 [INF] Removing 0 grants
2019-06-27 09:55:18.664 +01:00 [INF] Removing 0 grants
2019-06-27 09:55:48.681 +01:00 [INF] Removing 0 grants
2019-06-27 09:56:18.724 +01:00 [INF] Removing 0 grants
2019-06-27 09:56:48.754 +01:00 [INF] Removing 0 grants
2019-06-27 09:57:18.777 +01:00 [INF] Removing 0 grants
2019-06-27 09:57:48.796 +01:00 [INF] Removing 0 grants
2019-06-27 09:58:18.811 +01:00 [INF] Removing 0 grants
2019-06-27 09:58:48.833 +01:00 [INF] Removing 0 grants
2019-06-27 09:59:18.837 +01:00 [INF] Removing 0 grants
2019-06-27 09:59:48.854 +01:00 [INF] Removing 0 grants
2019-06-27 10:00:18.920 +01:00 [INF] Removing 0 grants
2019-06-27 10:00:48.992 +01:00 [INF] Removing 0 grants
2019-06-27 10:22:38.550 +01:00 [INF] Removing 0 grants
2019-06-27 10:23:08.556 +01:00 [INF] Removing 0 grants
2019-06-27 10:45:24.162 +01:00 [INF] Removing 0 grants
2019-06-27 10:45:54.202 +01:00 [INF] Removing 0 grants
2019-06-27 11:08:09.363 +01:00 [INF] Removing 0 grants
2019-06-27 11:08:39.383 +01:00 [INF] Removing 0 grants
2019-06-27 11:30:53.504 +01:00 [INF] Removing 0 grants
2019-06-27 11:31:23.535 +01:00 [INF] Removing 0 grants
2019-06-27 11:53:40.297 +01:00 [INF] Removing 0 grants
2019-06-27 11:54:10.308 +01:00 [INF] Removing 0 grants
2019-06-27 12:16:25.434 +01:00 [INF] Removing 0 grants
2019-06-27 12:16:55.460 +01:00 [INF] Removing 0 grants
2019-06-27 12:39:10.259 +01:00 [INF] Removing 0 grants
2019-06-27 12:39:40.269 +01:00 [INF] Removing 0 grants
2019-06-27 13:01:55.339 +01:00 [INF] Removing 0 grants
2019-06-27 13:02:25.345 +01:00 [INF] Removing 0 grants
2019-06-27 13:24:40.348 +01:00 [INF] Removing 0 grants
2019-06-27 13:25:10.377 +01:00 [INF] Removing 0 grants
2019-06-27 13:38:52.220 +01:00 [INF] Removing 0 grants
2019-06-29 01:20:36.084 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 01:20:36.137 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 01:20:36.142 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 01:20:36.142 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 01:20:36.143 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 01:20:36.166 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 01:20:36.527 +01:00 [DBG] Starting grant removal
2019-06-29 01:20:44.123 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 01:20:44.132 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 01:20:44.134 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 01:20:44.135 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 01:20:44.136 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 01:20:44.137 +01:00 [DBG] Error Url: /home/error
2019-06-29 01:20:44.138 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 01:20:44.180 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 01:20:44.196 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 01:20:44.200 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 01:20:44.209 +01:00 [DBG] Start discovery request
2019-06-29 01:21:07.252 +01:00 [INF] Removing 0 grants
2019-06-29 11:34:27.517 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 11:34:27.672 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 11:34:27.685 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 11:34:27.691 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 11:34:27.699 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 11:34:27.704 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 11:34:28.157 +01:00 [DBG] Starting grant removal
2019-06-29 11:34:32.576 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 11:34:32.580 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 11:34:32.582 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 11:34:32.585 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 11:34:32.609 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 11:34:32.619 +01:00 [DBG] Error Url: /home/error
2019-06-29 11:34:32.623 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 11:34:59.215 +01:00 [INF] Removing 0 grants
2019-06-29 11:35:29.562 +01:00 [INF] Removing 0 grants
2019-06-29 11:35:59.814 +01:00 [INF] Removing 0 grants
2019-06-29 11:36:30.089 +01:00 [INF] Removing 0 grants
2019-06-29 11:37:01.244 +01:00 [INF] Removing 0 grants
2019-06-29 11:37:31.260 +01:00 [INF] Removing 0 grants
2019-06-29 11:38:01.298 +01:00 [INF] Removing 0 grants
2019-06-29 11:38:31.477 +01:00 [INF] Removing 0 grants
2019-06-29 11:39:01.599 +01:00 [INF] Removing 0 grants
2019-06-29 11:39:31.674 +01:00 [INF] Removing 0 grants
2019-06-29 11:40:01.687 +01:00 [INF] Removing 0 grants
2019-06-29 11:40:31.914 +01:00 [INF] Removing 0 grants
2019-06-29 11:41:02.097 +01:00 [INF] Removing 0 grants
2019-06-29 11:41:32.913 +01:00 [INF] Removing 0 grants
2019-06-29 11:42:03.360 +01:00 [INF] Removing 0 grants
2019-06-29 11:42:34.794 +01:00 [INF] Removing 0 grants
2019-06-29 11:43:06.090 +01:00 [INF] Removing 0 grants
2019-06-29 11:43:36.158 +01:00 [INF] Removing 0 grants
2019-06-29 11:44:06.277 +01:00 [INF] Removing 0 grants
2019-06-29 11:44:16.006 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 11:44:16.027 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 11:44:16.028 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 11:44:16.034 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 11:44:16.106 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 11:44:16.107 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 11:44:16.124 +01:00 [DBG] Start discovery request
2019-06-29 11:44:16.335 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 11:44:16.369 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 11:44:16.387 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 11:44:16.429 +01:00 [DBG] Start authorize request
2019-06-29 11:44:16.471 +01:00 [DBG] No user present in authorize request
2019-06-29 11:44:16.486 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 11:44:16.540 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 11:44:16.629 +01:00 [ERR] Invalid grant type for client: implicit
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"","State":"21a07d109b7a47569c41c5466edd5d6a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"21a07d109b7a47569c41c5466edd5d6a","nonce":"f5c754d7a0914841a8fac4417254b375"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 11:44:16.756 +01:00 [ERR] Request validation failed
2019-06-29 11:44:16.765 +01:00 [INF] {"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"","State":"21a07d109b7a47569c41c5466edd5d6a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"21a07d109b7a47569c41c5466edd5d6a","nonce":"f5c754d7a0914841a8fac4417254b375"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 11:44:36.314 +01:00 [INF] Removing 0 grants
2019-06-29 11:45:06.325 +01:00 [INF] Removing 0 grants
2019-06-29 11:45:36.324 +01:00 [INF] Removing 0 grants
2019-06-29 11:46:06.330 +01:00 [INF] Removing 0 grants
2019-06-29 11:46:36.344 +01:00 [INF] Removing 0 grants
2019-06-29 11:47:06.345 +01:00 [INF] Removing 0 grants
2019-06-29 11:47:36.420 +01:00 [INF] Removing 0 grants
2019-06-29 11:48:06.512 +01:00 [INF] Removing 0 grants
2019-06-29 11:48:36.527 +01:00 [INF] Removing 0 grants
2019-06-29 11:49:06.535 +01:00 [INF] Removing 0 grants
2019-06-29 11:49:36.537 +01:00 [INF] Removing 0 grants
2019-06-29 11:50:06.544 +01:00 [INF] Removing 0 grants
2019-06-29 11:50:36.568 +01:00 [INF] Removing 0 grants
2019-06-29 11:51:06.569 +01:00 [INF] Removing 0 grants
2019-06-29 11:51:36.595 +01:00 [INF] Removing 0 grants
2019-06-29 11:52:06.611 +01:00 [INF] Removing 0 grants
2019-06-29 11:52:36.611 +01:00 [INF] Removing 0 grants
2019-06-29 11:53:06.633 +01:00 [INF] Removing 0 grants
2019-06-29 11:53:36.643 +01:00 [INF] Removing 0 grants
2019-06-29 11:54:06.663 +01:00 [INF] Removing 0 grants
2019-06-29 11:54:36.696 +01:00 [INF] Removing 0 grants
2019-06-29 11:55:06.698 +01:00 [INF] Removing 0 grants
2019-06-29 11:55:36.716 +01:00 [INF] Removing 0 grants
2019-06-29 11:56:06.714 +01:00 [INF] Removing 0 grants
2019-06-29 11:56:36.749 +01:00 [INF] Removing 0 grants
2019-06-29 11:57:06.751 +01:00 [INF] Removing 0 grants
2019-06-29 11:57:36.766 +01:00 [INF] Removing 0 grants
2019-06-29 11:58:06.769 +01:00 [INF] Removing 0 grants
2019-06-29 11:58:39.965 +01:00 [INF] Removing 0 grants
2019-06-29 11:59:09.975 +01:00 [INF] Removing 0 grants
2019-06-29 12:16:56.314 +01:00 [INF] Removing 0 grants
2019-06-29 12:17:26.339 +01:00 [INF] Removing 0 grants
2019-06-29 12:17:56.346 +01:00 [INF] Removing 0 grants
2019-06-29 12:18:26.387 +01:00 [INF] Removing 0 grants
2019-06-29 12:19:11.942 +01:00 [INF] Removing 0 grants
2019-06-29 12:19:41.961 +01:00 [INF] Removing 0 grants
2019-06-29 13:01:24.944 +01:00 [INF] Removing 0 grants
2019-06-29 13:01:55.117 +01:00 [INF] Removing 0 grants
2019-06-29 13:02:26.676 +01:00 [INF] Removing 0 grants
2019-06-29 13:02:56.691 +01:00 [INF] Removing 0 grants
2019-06-29 13:05:33.115 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 13:06:31.540 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 13:06:31.541 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 13:06:31.541 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 13:06:31.542 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 13:06:31.543 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 13:06:31.739 +01:00 [DBG] Starting grant removal
2019-06-29 13:06:33.301 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 13:06:33.306 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 13:06:33.307 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 13:06:33.309 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 13:06:33.310 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 13:06:33.311 +01:00 [DBG] Error Url: /home/error
2019-06-29 13:06:33.313 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 13:06:46.407 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:06:46.462 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:06:46.468 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:06:46.479 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:06:46.496 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:06:46.499 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:06:46.509 +01:00 [DBG] Start discovery request
2019-06-29 13:06:46.662 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 13:06:46.674 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 13:06:46.675 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 13:06:46.691 +01:00 [DBG] Start authorize request
2019-06-29 13:06:46.701 +01:00 [DBG] No user present in authorize request
2019-06-29 13:06:46.707 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:06:46.739 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:06:46.772 +01:00 [ERR] Client requested access token - but client is not configured to receive access tokens via browser
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"","State":"ebbf8e1d15f0419e9f2e5b56c7405674","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"ebbf8e1d15f0419e9f2e5b56c7405674","nonce":"5722c4c0531949f9b157402d0114d99e"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:06:46.820 +01:00 [ERR] Request validation failed
2019-06-29 13:06:46.832 +01:00 [INF] {"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"","State":"ebbf8e1d15f0419e9f2e5b56c7405674","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"ebbf8e1d15f0419e9f2e5b56c7405674","nonce":"5722c4c0531949f9b157402d0114d99e"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:07:01.856 +01:00 [INF] Removing 0 grants
2019-06-29 13:07:31.860 +01:00 [INF] Removing 0 grants
2019-06-29 13:10:00.400 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 13:10:03.638 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 13:10:03.639 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 13:10:03.639 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 13:10:03.640 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 13:10:03.640 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 13:10:03.866 +01:00 [DBG] Starting grant removal
2019-06-29 13:10:05.458 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 13:10:05.590 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 13:10:05.629 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 13:10:05.658 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 13:10:05.659 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 13:10:05.665 +01:00 [DBG] Error Url: /home/error
2019-06-29 13:10:05.677 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 13:10:34.299 +01:00 [INF] Removing 0 grants
2019-06-29 13:11:09.355 +01:00 [INF] Removing 0 grants
2019-06-29 13:11:39.385 +01:00 [INF] Removing 0 grants
2019-06-29 13:12:09.419 +01:00 [INF] Removing 0 grants
2019-06-29 13:12:39.437 +01:00 [INF] Removing 0 grants
2019-06-29 13:13:04.607 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:13:04.633 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:13:04.636 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:13:04.643 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:13:04.660 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:13:04.664 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:13:04.670 +01:00 [DBG] Start discovery request
2019-06-29 13:13:04.830 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 13:13:04.918 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 13:13:04.939 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 13:13:04.969 +01:00 [DBG] Start authorize request
2019-06-29 13:13:05.004 +01:00 [DBG] No user present in authorize request
2019-06-29 13:13:05.018 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:13:05.057 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:13:05.126 +01:00 [ERR] Invalid scope: email
2019-06-29 13:13:05.144 +01:00 [ERR] Request validation failed
2019-06-29 13:13:05.174 +01:00 [INF] {"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"e5478654a763458a9c0b994456f97142","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"e5478654a763458a9c0b994456f97142","nonce":"98dd7fa57d1243169f34e4f9045f806d"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:13:09.459 +01:00 [INF] Removing 0 grants
2019-06-29 13:13:39.478 +01:00 [INF] Removing 0 grants
2019-06-29 13:14:09.511 +01:00 [INF] Removing 0 grants
2019-06-29 13:15:03.377 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 13:15:03.423 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 13:15:03.423 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 13:15:03.424 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 13:15:03.425 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 13:15:03.425 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 13:15:03.721 +01:00 [DBG] Starting grant removal
2019-06-29 13:15:05.493 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 13:15:05.516 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 13:15:05.521 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 13:15:05.533 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 13:15:05.550 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 13:15:05.554 +01:00 [DBG] Error Url: /home/error
2019-06-29 13:15:05.577 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 13:15:34.981 +01:00 [INF] Removing 0 grants
2019-06-29 13:15:43.088 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:15:43.118 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:15:43.127 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:15:43.133 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:15:43.179 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:15:43.195 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:15:43.230 +01:00 [DBG] Start discovery request
2019-06-29 13:15:43.382 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 13:15:43.401 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 13:15:43.412 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 13:15:43.425 +01:00 [DBG] Start authorize request
2019-06-29 13:15:43.440 +01:00 [DBG] No user present in authorize request
2019-06-29 13:15:43.460 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:15:43.512 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:15:43.567 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:15:43.606 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"805b54e763f34c829b8dceb49eec8e26","UiLocales":null,"Nonce":"029177bbfd3d4ab482c6a8caf019135e","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"805b54e763f34c829b8dceb49eec8e26","nonce":"029177bbfd3d4ab482c6a8caf019135e"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:15:43.812 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 13:15:43.912 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:15:43.913 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:15:43.923 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:15:43.931 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:16:00.347 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 13:16:00.418 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:16:00.419 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:16:00.440 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:16:00.738 +01:00 [WRN] Invalid password for user 757684ef-74a9-40eb-b2e1-cfb480e69209.
2019-06-29 13:16:00.757 +01:00 [WRN] User 757684ef-74a9-40eb-b2e1-cfb480e69209 failed to provide the correct password.
2019-06-29 13:16:01.246 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:16:01.249 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:16:01.256 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:16:01.257 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:16:05.441 +01:00 [INF] Removing 0 grants
2019-06-29 13:16:35.446 +01:00 [INF] Removing 0 grants
2019-06-29 13:17:04.002 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 13:17:04.006 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:17:04.011 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:04.014 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:17:04.472 +01:00 [DBG] Augmenting SignInContext
2019-06-29 13:17:04.485 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 13:17:04.497 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 13:17:04.499 +01:00 [DBG] Adding auth_time claim with value: 1561810624
2019-06-29 13:17:04.527 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 13:17:04.534 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:04.559 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 13:17:04.562 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 13:17:04.563 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 13:17:04.572 +01:00 [DBG] Start authorize callback request
2019-06-29 13:17:04.596 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:17:04.603 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:17:04.604 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:04.606 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:17:04.611 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"805b54e763f34c829b8dceb49eec8e26","UiLocales":null,"Nonce":"029177bbfd3d4ab482c6a8caf019135e","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1dc961c13814c3ec6db083506a105911","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"805b54e763f34c829b8dceb49eec8e26","nonce":"029177bbfd3d4ab482c6a8caf019135e"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:17:04.793 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: false
2019-06-29 13:17:04.805 +01:00 [DBG] user_consent grant with value: AngularClientApp|757684ef-74a9-40eb-b2e1-cfb480e69209 not found in store.
2019-06-29 13:17:04.806 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-29 13:17:04.808 +01:00 [INF] Showing consent: User has not yet consented
2019-06-29 13:17:04.889 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:17:04.905 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:04.909 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:17:04.912 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:05.497 +01:00 [INF] Removing 0 grants
2019-06-29 13:17:11.091 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 13:17:11.158 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:17:11.160 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:11.173 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:17:11.205 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:11.219 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 13:17:11.222 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 13:17:11.277 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 13:17:11.280 +01:00 [DBG] Start authorize callback request
2019-06-29 13:17:11.306 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:17:11.337 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:17:11.338 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:11.368 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:17:11.397 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"805b54e763f34c829b8dceb49eec8e26","UiLocales":null,"Nonce":"029177bbfd3d4ab482c6a8caf019135e","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1dc961c13814c3ec6db083506a105911","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"805b54e763f34c829b8dceb49eec8e26","nonce":"029177bbfd3d4ab482c6a8caf019135e"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:17:11.495 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: false
2019-06-29 13:17:11.498 +01:00 [DBG] user_consent grant with value: AngularClientApp|757684ef-74a9-40eb-b2e1-cfb480e69209 not found in store.
2019-06-29 13:17:11.499 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-29 13:17:11.509 +01:00 [INF] User consented to scopes: ["openid","profile","email"]
2019-06-29 13:17:11.523 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2019-06-29 13:17:11.535 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:17:11.575 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= not found in database
2019-06-29 13:17:12.054 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 13:17:12.069 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 13:17:12.072 +01:00 [DBG] Getting claims for access token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:17:12.358 +01:00 [DBG] Getting claims for identity token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209 and client: AngularClientApp
2019-06-29 13:17:12.359 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 13:17:12.386 +01:00 [INF] Authorize endpoint response
{"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"805b54e763f34c829b8dceb49eec8e26","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 13:17:12.420 +01:00 [DBG] Augmenting SignInContext
2019-06-29 13:17:12.423 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 13:17:14.757 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:17:14.799 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:17:14.825 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:17:14.938 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:17:15.084 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:17:15.166 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:17:15.208 +01:00 [DBG] Start discovery request
2019-06-29 13:17:15.455 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 13:17:15.756 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:17:15.874 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:17:15.913 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 13:17:16.208 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 13:17:16.211 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 13:17:16.217 +01:00 [DBG] Start key discovery request
2019-06-29 13:17:16.291 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 13:17:16.295 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:17:16.297 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:17:16.596 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 13:17:16.624 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:17:16.662 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:17:16.664 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 13:17:16.669 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 13:17:16.677 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 13:17:16.716 +01:00 [DBG] Start userinfo request
2019-06-29 13:17:16.738 +01:00 [DBG] Bearer token found in header
2019-06-29 13:17:16.842 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:16.867 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:17:17.059 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 13:17:17.079 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561810632,"exp":1561814232,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"AngularClientApp","sub":"757684ef-74a9-40eb-b2e1-cfb480e69209","auth_time":1561810624,"idp":"local","scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 13:17:17.107 +01:00 [DBG] Creating userinfo response
2019-06-29 13:17:17.121 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:17:17.128 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:17:17.156 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-29 13:17:17.169 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:17:17.215 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website preferred_username
2019-06-29 13:17:17.274 +01:00 [DBG] End userinfo request
2019-06-29 13:17:17.615 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 13:17:17.774 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 13:17:17.804 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 13:17:17.837 +01:00 [DBG] Rendering check session result
2019-06-29 13:17:35.633 +01:00 [INF] Removing 0 grants
2019-06-29 13:18:05.671 +01:00 [INF] Removing 0 grants
2019-06-29 13:18:35.708 +01:00 [INF] Removing 0 grants
2019-06-29 13:19:05.719 +01:00 [INF] Removing 0 grants
2019-06-29 13:19:35.724 +01:00 [INF] Removing 0 grants
2019-06-29 13:20:05.765 +01:00 [INF] Removing 0 grants
2019-06-29 13:44:13.439 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 13:44:13.477 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 13:44:13.479 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 13:44:13.480 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 13:44:13.480 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 13:44:13.481 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 13:44:13.591 +01:00 [DBG] Starting grant removal
2019-06-29 13:44:14.580 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 13:44:14.734 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 13:44:14.735 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 13:44:14.780 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 13:44:14.781 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 13:44:14.785 +01:00 [DBG] Error Url: /home/error
2019-06-29 13:44:14.787 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 13:44:33.994 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:44:34.120 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:44:34.193 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:44:34.243 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:44:34.375 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:44:34.441 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:44:34.483 +01:00 [DBG] Start discovery request
2019-06-29 13:44:34.711 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 13:44:34.791 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 13:44:34.799 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 13:44:34.811 +01:00 [DBG] Rendering check session result
2019-06-29 13:44:39.037 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 13:44:39.080 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 13:44:39.089 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 13:44:39.117 +01:00 [DBG] Start authorize request
2019-06-29 13:44:39.150 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:44:39.159 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:44:39.189 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:44:39.228 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:44:39.283 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"b5badc6200064c668153b90045bdf262","UiLocales":null,"Nonce":"9833ff9d218442a9a1de3b7b0f37b753","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1dc961c13814c3ec6db083506a105911","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"b5badc6200064c668153b90045bdf262","nonce":"9833ff9d218442a9a1de3b7b0f37b753"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:44:40.003 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: true
2019-06-29 13:44:40.041 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 13:44:40.070 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 13:44:40.098 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 13:44:40.107 +01:00 [DBG] Getting claims for access token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:44:40.481 +01:00 [DBG] Getting claims for identity token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209 and client: AngularClientApp
2019-06-29 13:44:40.489 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 13:44:40.513 +01:00 [INF] Authorize endpoint response
{"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"b5badc6200064c668153b90045bdf262","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 13:44:42.144 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:44:42.341 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:44:42.452 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:44:42.495 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:44:42.527 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:44:42.562 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:44:42.572 +01:00 [DBG] Start discovery request
2019-06-29 13:44:42.577 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:44:42.601 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:44:42.604 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:44:42.616 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:44:42.619 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:44:42.621 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:44:42.640 +01:00 [DBG] Start discovery request
2019-06-29 13:44:42.748 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 13:44:42.790 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 13:44:42.792 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 13:44:42.795 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:44:42.803 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:44:42.804 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 13:44:42.818 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 13:44:42.825 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 13:44:42.830 +01:00 [DBG] Start key discovery request
2019-06-29 13:44:42.859 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 13:44:42.864 +01:00 [DBG] Rendering check session result
2019-06-29 13:44:42.953 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 13:44:43.020 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:44:43.062 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:44:43.092 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 13:44:43.094 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:44:43.096 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:44:43.097 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 13:44:43.102 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 13:44:43.103 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 13:44:43.125 +01:00 [DBG] Start userinfo request
2019-06-29 13:44:43.155 +01:00 [DBG] Bearer token found in header
2019-06-29 13:44:43.237 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:44:43.241 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:44:43.252 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 13:44:43.256 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561812280,"exp":1561815880,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"AngularClientApp","sub":"757684ef-74a9-40eb-b2e1-cfb480e69209","auth_time":1561810624,"idp":"local","scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 13:44:43.287 +01:00 [DBG] Creating userinfo response
2019-06-29 13:44:43.306 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:44:43.332 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:44:43.358 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-29 13:44:43.376 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:44:43.394 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website preferred_username
2019-06-29 13:44:43.397 +01:00 [DBG] End userinfo request
2019-06-29 13:44:43.613 +01:00 [INF] Removing 0 grants
2019-06-29 13:45:13.633 +01:00 [INF] Removing 0 grants
2019-06-29 13:45:43.655 +01:00 [INF] Removing 0 grants
2019-06-29 13:46:13.659 +01:00 [INF] Removing 0 grants
2019-06-29 13:46:43.668 +01:00 [INF] Removing 0 grants
2019-06-29 13:47:13.672 +01:00 [INF] Removing 0 grants
2019-06-29 13:47:43.672 +01:00 [INF] Removing 0 grants
2019-06-29 13:48:13.701 +01:00 [INF] Removing 0 grants
2019-06-29 13:48:43.721 +01:00 [INF] Removing 0 grants
2019-06-29 13:49:13.803 +01:00 [INF] Removing 0 grants
2019-06-29 13:49:43.836 +01:00 [INF] Removing 0 grants
2019-06-29 13:50:13.839 +01:00 [INF] Removing 0 grants
2019-06-29 13:50:43.843 +01:00 [INF] Removing 0 grants
2019-06-29 13:51:13.845 +01:00 [INF] Removing 0 grants
2019-06-29 13:51:43.879 +01:00 [INF] Removing 0 grants
2019-06-29 13:52:13.888 +01:00 [INF] Removing 0 grants
2019-06-29 13:52:26.954 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:52:27.086 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:52:27.177 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:52:27.205 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:52:27.250 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:52:27.276 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:52:27.312 +01:00 [DBG] Start discovery request
2019-06-29 13:52:27.578 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 13:52:27.602 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 13:52:27.674 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 13:52:27.690 +01:00 [DBG] Rendering check session result
2019-06-29 13:52:43.895 +01:00 [INF] Removing 0 grants
2019-06-29 13:53:02.887 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:53:02.918 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:53:02.920 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:53:02.921 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:53:02.935 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:53:02.938 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:53:02.940 +01:00 [DBG] Start discovery request
2019-06-29 13:53:02.959 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 13:53:02.974 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 13:53:03.046 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 13:53:03.057 +01:00 [DBG] Start authorize request
2019-06-29 13:53:03.059 +01:00 [DBG] No user present in authorize request
2019-06-29 13:53:03.059 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:53:03.063 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:03.065 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:53:03.081 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"792ffd56c5994a229aa477eae2e06eaf","UiLocales":null,"Nonce":"5114b131679542c5a8fd1a2c2f1eecf0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"792ffd56c5994a229aa477eae2e06eaf","nonce":"5114b131679542c5a8fd1a2c2f1eecf0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:53:03.115 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 13:53:03.246 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:53:03.247 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:03.261 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:53:03.287 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:13.897 +01:00 [INF] Removing 0 grants
2019-06-29 13:53:19.221 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 13:53:19.312 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:53:19.314 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:19.315 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:53:19.470 +01:00 [DBG] Augmenting SignInContext
2019-06-29 13:53:19.490 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 13:53:19.491 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 13:53:19.493 +01:00 [DBG] Adding auth_time claim with value: 1561812799
2019-06-29 13:53:19.511 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 13:53:19.578 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:19.647 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 13:53:19.702 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 13:53:19.717 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 13:53:19.748 +01:00 [DBG] Start authorize callback request
2019-06-29 13:53:19.757 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:53:19.785 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 13:53:19.817 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:19.852 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 13:53:19.879 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"792ffd56c5994a229aa477eae2e06eaf","UiLocales":null,"Nonce":"5114b131679542c5a8fd1a2c2f1eecf0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b0b03c7b402c008f6b3a52d21124c2c8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"792ffd56c5994a229aa477eae2e06eaf","nonce":"5114b131679542c5a8fd1a2c2f1eecf0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 13:53:19.975 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: true
2019-06-29 13:53:19.992 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 13:53:20.000 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 13:53:20.000 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 13:53:20.001 +01:00 [DBG] Getting claims for access token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 13:53:20.039 +01:00 [DBG] Getting claims for identity token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209 and client: AngularClientApp
2019-06-29 13:53:20.053 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 13:53:20.069 +01:00 [INF] Authorize endpoint response
{"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"792ffd56c5994a229aa477eae2e06eaf","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 13:53:20.087 +01:00 [DBG] Augmenting SignInContext
2019-06-29 13:53:20.089 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 13:53:21.810 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 13:53:21.948 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:53:22.179 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:53:22.295 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 13:53:22.441 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 13:53:22.461 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 13:53:22.516 +01:00 [DBG] Start discovery request
2019-06-29 13:53:22.626 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 13:53:22.643 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:53:22.672 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:53:22.685 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 13:53:22.707 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 13:53:22.735 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 13:53:22.782 +01:00 [DBG] Start key discovery request
2019-06-29 13:53:22.992 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 13:53:23.046 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:53:23.052 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:53:23.074 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 13:53:23.086 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 13:53:23.088 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 13:53:23.089 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 13:53:23.093 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 13:53:23.097 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 13:53:23.101 +01:00 [DBG] Start userinfo request
2019-06-29 13:53:23.103 +01:00 [DBG] Bearer token found in header
2019-06-29 13:53:23.106 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:23.109 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 13:53:23.141 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 13:53:23.144 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561812800,"exp":1561816400,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"AngularClientApp","sub":"757684ef-74a9-40eb-b2e1-cfb480e69209","auth_time":1561812799,"idp":"local","scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 13:53:23.207 +01:00 [DBG] Creating userinfo response
2019-06-29 13:53:23.208 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:53:23.208 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:53:23.210 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-29 13:53:23.213 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 13:53:23.224 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website preferred_username
2019-06-29 13:53:23.236 +01:00 [DBG] End userinfo request
2019-06-29 13:53:23.317 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 13:53:23.324 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 13:53:23.362 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 13:53:23.381 +01:00 [DBG] Rendering check session result
2019-06-29 13:53:43.911 +01:00 [INF] Removing 0 grants
2019-06-29 13:54:13.912 +01:00 [INF] Removing 0 grants
2019-06-29 13:54:43.916 +01:00 [INF] Removing 0 grants
2019-06-29 13:55:13.956 +01:00 [INF] Removing 0 grants
2019-06-29 13:55:43.969 +01:00 [INF] Removing 0 grants
2019-06-29 13:56:13.997 +01:00 [INF] Removing 0 grants
2019-06-29 13:56:44.013 +01:00 [INF] Removing 0 grants
2019-06-29 13:57:14.009 +01:00 [INF] Removing 0 grants
2019-06-29 13:57:44.021 +01:00 [INF] Removing 0 grants
2019-06-29 13:58:14.030 +01:00 [INF] Removing 0 grants
2019-06-29 13:58:44.031 +01:00 [INF] Removing 0 grants
2019-06-29 13:59:14.046 +01:00 [INF] Removing 0 grants
2019-06-29 13:59:44.038 +01:00 [INF] Removing 0 grants
2019-06-29 14:00:14.047 +01:00 [INF] Removing 0 grants
2019-06-29 14:00:44.058 +01:00 [INF] Removing 0 grants
2019-06-29 14:01:14.077 +01:00 [INF] Removing 0 grants
2019-06-29 14:01:44.078 +01:00 [INF] Removing 0 grants
2019-06-29 14:02:14.100 +01:00 [INF] Removing 0 grants
2019-06-29 14:02:44.103 +01:00 [INF] Removing 0 grants
2019-06-29 14:03:14.130 +01:00 [INF] Removing 0 grants
2019-06-29 14:03:44.143 +01:00 [INF] Removing 0 grants
2019-06-29 14:04:14.149 +01:00 [INF] Removing 0 grants
2019-06-29 14:04:44.174 +01:00 [INF] Removing 0 grants
2019-06-29 14:05:14.184 +01:00 [INF] Removing 0 grants
2019-06-29 14:05:44.225 +01:00 [INF] Removing 0 grants
2019-06-29 14:06:14.290 +01:00 [INF] Removing 0 grants
2019-06-29 14:06:44.306 +01:00 [INF] Removing 0 grants
2019-06-29 14:07:14.310 +01:00 [INF] Removing 0 grants
2019-06-29 14:07:44.337 +01:00 [INF] Removing 0 grants
2019-06-29 14:08:14.367 +01:00 [INF] Removing 0 grants
2019-06-29 14:08:44.378 +01:00 [INF] Removing 0 grants
2019-06-29 14:09:14.383 +01:00 [INF] Removing 0 grants
2019-06-29 14:09:44.392 +01:00 [INF] Removing 0 grants
2019-06-29 14:09:59.554 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:09:59.735 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:09:59.975 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:00.077 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:10:00.215 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:10:00.248 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:10:00.281 +01:00 [DBG] Start discovery request
2019-06-29 14:10:00.394 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:10:00.522 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:10:00.585 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:10:00.588 +01:00 [DBG] Rendering check session result
2019-06-29 14:10:06.558 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:10:06.670 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:10:06.912 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:07.007 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:10:07.166 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:10:07.319 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:10:07.578 +01:00 [DBG] Start discovery request
2019-06-29 14:10:07.786 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:10:07.797 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:10:07.799 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:10:07.832 +01:00 [DBG] Rendering check session result
2019-06-29 14:10:14.391 +01:00 [INF] Removing 0 grants
2019-06-29 14:10:20.364 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:10:20.394 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:10:20.398 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:20.400 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:10:20.418 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:10:20.420 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:10:20.422 +01:00 [DBG] Start discovery request
2019-06-29 14:10:20.451 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 14:10:20.468 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 14:10:20.479 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 14:10:20.482 +01:00 [DBG] Start authorize request
2019-06-29 14:10:20.493 +01:00 [DBG] No user present in authorize request
2019-06-29 14:10:20.494 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:10:20.496 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:20.499 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:10:20.501 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"fe49c826fb4f46c6b149d4d1a2a24e60","UiLocales":null,"Nonce":"6f212568f1ab4907840ce301474f4465","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"fe49c826fb4f46c6b149d4d1a2a24e60","nonce":"6f212568f1ab4907840ce301474f4465"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:10:20.540 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 14:10:20.557 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:10:20.557 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:20.562 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:10:20.564 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:40.401 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 14:10:40.431 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:10:40.434 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:40.446 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:10:40.520 +01:00 [DBG] Augmenting SignInContext
2019-06-29 14:10:40.534 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 14:10:40.536 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 14:10:40.537 +01:00 [DBG] Adding auth_time claim with value: 1561813840
2019-06-29 14:10:40.548 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 14:10:40.554 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:40.570 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 14:10:40.572 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 14:10:40.574 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 14:10:40.594 +01:00 [DBG] Start authorize callback request
2019-06-29 14:10:40.611 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 14:10:40.639 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:10:40.650 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:40.652 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:10:40.654 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email","State":"fe49c826fb4f46c6b149d4d1a2a24e60","UiLocales":null,"Nonce":"6f212568f1ab4907840ce301474f4465","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"92d8d503fde85302464dd536dd2b5d58","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email","state":"fe49c826fb4f46c6b149d4d1a2a24e60","nonce":"6f212568f1ab4907840ce301474f4465"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:10:40.692 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: true
2019-06-29 14:10:40.699 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 14:10:40.709 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 14:10:40.710 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 14:10:40.712 +01:00 [DBG] Getting claims for access token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 14:10:40.727 +01:00 [DBG] Getting claims for identity token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209 and client: AngularClientApp
2019-06-29 14:10:40.737 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 14:10:40.747 +01:00 [INF] Authorize endpoint response
{"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"fe49c826fb4f46c6b149d4d1a2a24e60","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 14:10:40.757 +01:00 [DBG] Augmenting SignInContext
2019-06-29 14:10:40.759 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 14:10:42.307 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:10:42.534 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:10:42.727 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:42.880 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:10:42.985 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:10:43.049 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:10:43.211 +01:00 [DBG] Start discovery request
2019-06-29 14:10:43.440 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 14:10:43.527 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:10:43.542 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:43.545 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 14:10:43.548 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 14:10:43.550 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 14:10:43.553 +01:00 [DBG] Start key discovery request
2019-06-29 14:10:43.610 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 14:10:43.636 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:10:43.645 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:43.651 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 14:10:43.657 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:10:43.669 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:10:43.670 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 14:10:43.672 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 14:10:43.673 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 14:10:43.675 +01:00 [DBG] Start userinfo request
2019-06-29 14:10:43.677 +01:00 [DBG] Bearer token found in header
2019-06-29 14:10:43.694 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:43.698 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:10:43.708 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 14:10:43.714 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561813840,"exp":1561817440,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"AngularClientApp","sub":"757684ef-74a9-40eb-b2e1-cfb480e69209","auth_time":1561813840,"idp":"local","scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 14:10:43.730 +01:00 [DBG] Creating userinfo response
2019-06-29 14:10:43.730 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 14:10:43.732 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 14:10:43.734 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-29 14:10:43.736 +01:00 [DBG] Scopes in access token: openid profile email
2019-06-29 14:10:43.757 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website preferred_username
2019-06-29 14:10:43.758 +01:00 [DBG] End userinfo request
2019-06-29 14:10:43.844 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:10:43.887 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:10:43.945 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:10:43.990 +01:00 [DBG] Rendering check session result
2019-06-29 14:10:44.476 +01:00 [INF] Removing 0 grants
2019-06-29 14:11:14.510 +01:00 [INF] Removing 0 grants
2019-06-29 14:11:31.443 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:11:31.451 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:11:31.452 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:11:31.453 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:11:31.455 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:11:31.457 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:11:31.458 +01:00 [DBG] Start discovery request
2019-06-29 14:11:31.618 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:11:31.626 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:11:31.629 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:11:31.632 +01:00 [DBG] Rendering check session result
2019-06-29 14:11:44.546 +01:00 [INF] Removing 0 grants
2019-06-29 14:11:56.897 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:11:56.917 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:11:56.935 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:11:56.938 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:11:56.939 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:11:56.947 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:11:56.977 +01:00 [DBG] Start discovery request
2019-06-29 14:11:57.527 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:11:57.536 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:11:57.601 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:11:57.626 +01:00 [DBG] Rendering check session result
2019-06-29 14:12:14.554 +01:00 [INF] Removing 0 grants
2019-06-29 14:12:44.561 +01:00 [INF] Removing 0 grants
2019-06-29 14:13:14.576 +01:00 [INF] Removing 0 grants
2019-06-29 14:13:44.587 +01:00 [INF] Removing 0 grants
2019-06-29 14:14:14.595 +01:00 [INF] Removing 0 grants
2019-06-29 14:14:44.608 +01:00 [INF] Removing 0 grants
2019-06-29 14:15:14.613 +01:00 [INF] Removing 0 grants
2019-06-29 14:15:44.637 +01:00 [INF] Removing 0 grants
2019-06-29 14:16:14.655 +01:00 [INF] Removing 0 grants
2019-06-29 14:16:44.711 +01:00 [INF] Removing 0 grants
2019-06-29 14:17:14.732 +01:00 [INF] Removing 0 grants
2019-06-29 14:17:20.940 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:17:20.940 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:17:20.949 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:17:20.950 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:17:20.953 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:17:20.957 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:17:20.973 +01:00 [DBG] Start discovery request
2019-06-29 14:17:20.995 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 14:17:20.997 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 14:17:20.998 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 14:17:21.000 +01:00 [DBG] Start authorize request
2019-06-29 14:17:21.017 +01:00 [DBG] No user present in authorize request
2019-06-29 14:17:21.019 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:17:21.020 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:17:21.045 +01:00 [ERR] Invalid scope: userrole
2019-06-29 14:17:21.063 +01:00 [ERR] Request validation failed
2019-06-29 14:17:21.065 +01:00 [INF] {"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"da55ecacc82e4d988e6e65838c934436","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"da55ecacc82e4d988e6e65838c934436","nonce":"883c14670af74bb48b1862cc779ce067"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:17:44.743 +01:00 [INF] Removing 0 grants
2019-06-29 14:17:54.049 +01:00 [DBG] TaskCanceledException. Exiting.
2019-06-29 14:17:54.058 +01:00 [DBG] Stopping grant removal
2019-06-29 14:18:08.633 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 14:18:08.676 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 14:18:08.677 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 14:18:08.677 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 14:18:08.678 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 14:18:08.678 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 14:18:08.812 +01:00 [DBG] Starting grant removal
2019-06-29 14:18:09.853 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 14:18:09.865 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 14:18:09.868 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 14:18:09.872 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 14:18:09.876 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 14:18:09.882 +01:00 [DBG] Error Url: /home/error
2019-06-29 14:18:09.909 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 14:18:38.954 +01:00 [INF] Removing 0 grants
2019-06-29 14:19:01.822 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:19:01.832 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:19:01.836 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:19:01.838 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:19:01.876 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:19:01.877 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:19:01.897 +01:00 [DBG] Start discovery request
2019-06-29 14:19:02.000 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 14:19:02.013 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 14:19:02.030 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 14:19:02.040 +01:00 [DBG] Start authorize request
2019-06-29 14:19:02.062 +01:00 [DBG] No user present in authorize request
2019-06-29 14:19:02.077 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:19:02.126 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:19:02.169 +01:00 [ERR] Invalid scope: api.read
2019-06-29 14:19:02.173 +01:00 [ERR] Request validation failed
2019-06-29 14:19:02.228 +01:00 [INF] {"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"ecc3711f96f54c10885d281d8f2d961c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"ecc3711f96f54c10885d281d8f2d961c","nonce":"76a02e787bd245b8a4564584093deb7a"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:19:08.981 +01:00 [INF] Removing 0 grants
2019-06-29 14:19:38.996 +01:00 [INF] Removing 0 grants
2019-06-29 14:20:09.036 +01:00 [INF] Removing 0 grants
2019-06-29 14:20:23.607 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:20:23.614 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:20:23.615 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:20:23.617 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:20:23.620 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:20:23.635 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:20:23.638 +01:00 [DBG] Start discovery request
2019-06-29 14:20:23.664 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 14:20:23.676 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 14:20:23.708 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 14:20:23.713 +01:00 [DBG] Start authorize request
2019-06-29 14:20:23.728 +01:00 [DBG] No user present in authorize request
2019-06-29 14:20:23.730 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:20:23.732 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:20:23.738 +01:00 [ERR] Invalid scope: api.read
2019-06-29 14:20:23.761 +01:00 [ERR] Request validation failed
2019-06-29 14:20:23.762 +01:00 [INF] {"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"26b535fc7ee74c7ea32960797cd3d269","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"26b535fc7ee74c7ea32960797cd3d269","nonce":"5acdc175e3be47d097b6e70f445aa7df"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:20:39.042 +01:00 [INF] Removing 0 grants
2019-06-29 14:21:09.052 +01:00 [INF] Removing 0 grants
2019-06-29 14:21:39.069 +01:00 [INF] Removing 0 grants
2019-06-29 14:22:09.081 +01:00 [INF] Removing 0 grants
2019-06-29 14:22:39.097 +01:00 [INF] Removing 0 grants
2019-06-29 14:23:09.114 +01:00 [INF] Removing 0 grants
2019-06-29 14:23:39.127 +01:00 [INF] Removing 0 grants
2019-06-29 14:24:09.123 +01:00 [INF] Removing 0 grants
2019-06-29 14:24:39.138 +01:00 [INF] Removing 0 grants
2019-06-29 14:25:09.149 +01:00 [INF] Removing 0 grants
2019-06-29 14:25:13.897 +01:00 [DBG] TaskCanceledException. Exiting.
2019-06-29 14:25:13.944 +01:00 [DBG] Stopping grant removal
2019-06-29 14:25:19.236 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 14:25:19.274 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 14:25:19.275 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 14:25:19.276 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 14:25:19.276 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 14:25:19.277 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 14:25:19.386 +01:00 [DBG] Starting grant removal
2019-06-29 14:25:20.188 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 14:25:20.191 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 14:25:20.236 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 14:25:20.238 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 14:25:20.247 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 14:25:20.249 +01:00 [DBG] Error Url: /home/error
2019-06-29 14:25:20.250 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 14:25:49.491 +01:00 [INF] Removing 0 grants
2019-06-29 14:26:19.505 +01:00 [INF] Removing 0 grants
2019-06-29 14:26:49.506 +01:00 [INF] Removing 0 grants
2019-06-29 14:27:19.504 +01:00 [INF] Removing 0 grants
2019-06-29 14:27:31.649 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:27:31.660 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:27:31.662 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:27:31.666 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:27:31.680 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:27:31.681 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:27:31.690 +01:00 [DBG] Start discovery request
2019-06-29 14:27:31.875 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 14:27:31.890 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 14:27:31.893 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 14:27:31.899 +01:00 [DBG] Start authorize request
2019-06-29 14:27:31.909 +01:00 [DBG] No user present in authorize request
2019-06-29 14:27:31.918 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:27:31.968 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:32.036 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:27:32.061 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"aa07e4211d72474e920484ed97f37ff2","UiLocales":null,"Nonce":"c3eb4e9c81fb47e28271f989e9a60f17","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"aa07e4211d72474e920484ed97f37ff2","nonce":"c3eb4e9c81fb47e28271f989e9a60f17"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:27:32.126 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 14:27:32.219 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:27:32.222 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:32.229 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:27:32.235 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:46.847 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 14:27:46.970 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:27:46.970 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:46.971 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:27:47.387 +01:00 [DBG] Augmenting SignInContext
2019-06-29 14:27:47.391 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 14:27:47.396 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 14:27:47.398 +01:00 [DBG] Adding auth_time claim with value: 1561814867
2019-06-29 14:27:47.417 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 14:27:47.448 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:47.529 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 14:27:47.531 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 14:27:47.540 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 14:27:47.547 +01:00 [DBG] Start authorize callback request
2019-06-29 14:27:47.558 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 14:27:47.561 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:27:47.562 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:47.565 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:27:47.578 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"aa07e4211d72474e920484ed97f37ff2","UiLocales":null,"Nonce":"c3eb4e9c81fb47e28271f989e9a60f17","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"de65aa15c673545b5906768d6011b9d5","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"aa07e4211d72474e920484ed97f37ff2","nonce":"c3eb4e9c81fb47e28271f989e9a60f17"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:27:47.991 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: true
2019-06-29 14:27:48.016 +01:00 [DBG] Consent found in consent store is different than current request, consent is required
2019-06-29 14:27:48.018 +01:00 [INF] Showing consent: User has not yet consented
2019-06-29 14:27:48.063 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:27:48.064 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:48.074 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:27:48.075 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:27:49.515 +01:00 [INF] Removing 0 grants
2019-06-29 14:28:08.417 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 14:28:08.461 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:28:08.463 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:28:08.474 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:28:08.495 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:28:08.508 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 14:28:08.511 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 14:28:08.532 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 14:28:08.537 +01:00 [DBG] Start authorize callback request
2019-06-29 14:28:08.542 +01:00 [DBG] User in authorize request: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 14:28:08.550 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:28:08.551 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:28:08.553 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:28:08.555 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"aa07e4211d72474e920484ed97f37ff2","UiLocales":null,"Nonce":"c3eb4e9c81fb47e28271f989e9a60f17","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"de65aa15c673545b5906768d6011b9d5","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"aa07e4211d72474e920484ed97f37ff2","nonce":"c3eb4e9c81fb47e28271f989e9a60f17"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:28:08.610 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database: true
2019-06-29 14:28:08.626 +01:00 [DBG] Consent found in consent store is different than current request, consent is required
2019-06-29 14:28:08.634 +01:00 [INF] User consented to scopes: ["openid","profile","email","userrole","api.read"]
2019-06-29 14:28:08.638 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","userrole","api.read"]
2019-06-29 14:28:08.656 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 14:28:08.695 +01:00 [DBG] DYKQScb3gchS+NfAAVgKdvNY97cU5kW8HW7ZM0phFCs= found in database
2019-06-29 14:28:08.782 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 14:28:08.799 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 14:28:08.800 +01:00 [DBG] Getting claims for access token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209
2019-06-29 14:28:08.953 +01:00 [DBG] Getting claims for identity token for subject: 757684ef-74a9-40eb-b2e1-cfb480e69209 and client: AngularClientApp
2019-06-29 14:28:08.962 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 14:28:09.001 +01:00 [INF] Authorize endpoint response
{"SubjectId":"757684ef-74a9-40eb-b2e1-cfb480e69209","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"aa07e4211d72474e920484ed97f37ff2","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 14:28:09.037 +01:00 [DBG] Augmenting SignInContext
2019-06-29 14:28:09.044 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 14:28:11.035 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:28:11.162 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:28:11.294 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:28:11.480 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:28:11.610 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:28:11.728 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:28:11.808 +01:00 [DBG] Start discovery request
2019-06-29 14:28:11.896 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 14:28:11.947 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:28:11.984 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:28:11.988 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 14:28:12.019 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 14:28:12.097 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 14:28:12.116 +01:00 [DBG] Start key discovery request
2019-06-29 14:28:12.197 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 14:28:12.207 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:28:12.211 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:28:12.219 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 14:28:12.221 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:28:12.225 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:28:12.226 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 14:28:12.238 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 14:28:12.270 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 14:28:12.280 +01:00 [DBG] Start userinfo request
2019-06-29 14:28:12.292 +01:00 [DBG] Bearer token found in header
2019-06-29 14:28:12.382 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:28:12.400 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:28:12.418 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 14:28:12.422 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561814888,"exp":1561818488,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"757684ef-74a9-40eb-b2e1-cfb480e69209","auth_time":1561814867,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 14:28:12.461 +01:00 [DBG] Creating userinfo response
2019-06-29 14:28:12.466 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 14:28:12.472 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 14:28:12.487 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 14:28:12.489 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 14:28:12.496 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website preferred_username
2019-06-29 14:28:12.503 +01:00 [DBG] End userinfo request
2019-06-29 14:28:12.561 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:28:12.617 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:28:12.643 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:28:12.651 +01:00 [DBG] Rendering check session result
2019-06-29 14:28:19.522 +01:00 [INF] Removing 0 grants
2019-06-29 14:28:49.530 +01:00 [INF] Removing 0 grants
2019-06-29 14:29:19.543 +01:00 [INF] Removing 0 grants
2019-06-29 14:29:49.564 +01:00 [INF] Removing 0 grants
2019-06-29 14:30:19.579 +01:00 [INF] Removing 0 grants
2019-06-29 14:36:26.093 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 14:36:26.125 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 14:36:26.127 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 14:36:26.127 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 14:36:26.128 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 14:36:26.129 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 14:36:26.353 +01:00 [DBG] Starting grant removal
2019-06-29 14:36:27.875 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 14:36:27.909 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 14:36:27.913 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 14:36:27.929 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 14:36:27.929 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 14:36:27.930 +01:00 [DBG] Error Url: /home/error
2019-06-29 14:36:27.931 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 14:36:56.427 +01:00 [INF] Removing 0 grants
2019-06-29 14:39:19.012 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 14:39:19.046 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 14:39:19.047 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 14:39:19.048 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 14:39:19.048 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 14:39:19.049 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 14:39:19.148 +01:00 [DBG] Starting grant removal
2019-06-29 14:39:20.010 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 14:39:20.017 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 14:39:20.021 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 14:39:20.026 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 14:39:20.032 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 14:39:20.033 +01:00 [DBG] Error Url: /home/error
2019-06-29 14:39:20.034 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 14:39:48.758 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:39:48.768 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:39:48.770 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:39:48.775 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:39:48.798 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:39:48.804 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:39:48.822 +01:00 [DBG] Start discovery request
2019-06-29 14:39:48.978 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 14:39:48.996 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 14:39:49.002 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 14:39:49.016 +01:00 [DBG] Start authorize request
2019-06-29 14:39:49.033 +01:00 [DBG] No user present in authorize request
2019-06-29 14:39:49.039 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:39:49.072 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:39:49.146 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:39:49.229 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"e7b0a1ad54c14fe0a630ab3b07a6af74","UiLocales":null,"Nonce":"2ff21ae6b2f14470a20be4f4dd20b06a","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"e7b0a1ad54c14fe0a630ab3b07a6af74","nonce":"2ff21ae6b2f14470a20be4f4dd20b06a"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:39:49.234 +01:00 [INF] Removing 0 grants
2019-06-29 14:39:49.287 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 14:39:49.358 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:39:49.359 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:39:49.367 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:39:49.374 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:07.068 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 14:40:07.133 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:07.134 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:07.135 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:07.317 +01:00 [WRN] Invalid password for user eb81adad-cde8-490d-972d-242c5668e094.
2019-06-29 14:40:07.326 +01:00 [WRN] User eb81adad-cde8-490d-972d-242c5668e094 failed to provide the correct password.
2019-06-29 14:40:07.440 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:07.441 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:07.455 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:07.456 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:19.240 +01:00 [INF] Removing 0 grants
2019-06-29 14:40:22.816 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 14:40:22.848 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:22.850 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:22.853 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:23.254 +01:00 [DBG] Augmenting SignInContext
2019-06-29 14:40:23.262 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 14:40:23.264 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 14:40:23.265 +01:00 [DBG] Adding auth_time claim with value: 1561815623
2019-06-29 14:40:23.279 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 14:40:23.292 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:23.331 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 14:40:23.334 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 14:40:23.337 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 14:40:23.349 +01:00 [DBG] Start authorize callback request
2019-06-29 14:40:23.360 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 14:40:23.364 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:23.368 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:23.382 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:23.385 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"e7b0a1ad54c14fe0a630ab3b07a6af74","UiLocales":null,"Nonce":"2ff21ae6b2f14470a20be4f4dd20b06a","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1c414fcece6f629dd57edbbc9cafa15a","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"e7b0a1ad54c14fe0a630ab3b07a6af74","nonce":"2ff21ae6b2f14470a20be4f4dd20b06a"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:40:23.467 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: false
2019-06-29 14:40:23.469 +01:00 [DBG] user_consent grant with value: AngularClientApp|eb81adad-cde8-490d-972d-242c5668e094 not found in store.
2019-06-29 14:40:23.478 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-29 14:40:23.480 +01:00 [INF] Showing consent: User has not yet consented
2019-06-29 14:40:23.538 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:23.542 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:23.553 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:23.555 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:26.812 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 14:40:26.829 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:26.831 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:26.839 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:26.899 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:26.932 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 14:40:26.935 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 14:40:26.967 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 14:40:26.988 +01:00 [DBG] Start authorize callback request
2019-06-29 14:40:27.002 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 14:40:27.004 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 14:40:27.006 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:27.024 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 14:40:27.029 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"e7b0a1ad54c14fe0a630ab3b07a6af74","UiLocales":null,"Nonce":"2ff21ae6b2f14470a20be4f4dd20b06a","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1c414fcece6f629dd57edbbc9cafa15a","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"e7b0a1ad54c14fe0a630ab3b07a6af74","nonce":"2ff21ae6b2f14470a20be4f4dd20b06a"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 14:40:27.080 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: false
2019-06-29 14:40:27.095 +01:00 [DBG] user_consent grant with value: AngularClientApp|eb81adad-cde8-490d-972d-242c5668e094 not found in store.
2019-06-29 14:40:27.099 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-29 14:40:27.112 +01:00 [INF] User consented to scopes: ["openid","profile","email","userrole","api.read"]
2019-06-29 14:40:27.124 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","userrole","api.read"]
2019-06-29 14:40:27.137 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 14:40:27.177 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= not found in database
2019-06-29 14:40:27.570 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 14:40:27.590 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 14:40:27.591 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 14:40:27.724 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 14:40:27.737 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 14:40:27.760 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"e7b0a1ad54c14fe0a630ab3b07a6af74","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 14:40:27.797 +01:00 [DBG] Augmenting SignInContext
2019-06-29 14:40:27.807 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 14:40:29.654 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 14:40:29.868 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:40:30.096 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:40:30.165 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 14:40:30.181 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 14:40:30.250 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 14:40:30.253 +01:00 [DBG] Start discovery request
2019-06-29 14:40:30.498 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 14:40:30.525 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:40:30.528 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:40:30.543 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 14:40:30.569 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 14:40:30.600 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 14:40:30.652 +01:00 [DBG] Start key discovery request
2019-06-29 14:40:30.696 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 14:40:30.703 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:40:30.706 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:40:30.736 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 14:40:30.746 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 14:40:30.748 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 14:40:30.750 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 14:40:30.754 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 14:40:30.756 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 14:40:30.778 +01:00 [DBG] Start userinfo request
2019-06-29 14:40:30.783 +01:00 [DBG] Bearer token found in header
2019-06-29 14:40:30.859 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:30.869 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 14:40:30.891 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 14:40:30.901 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561815627,"exp":1561819227,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561815623,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 14:40:30.944 +01:00 [DBG] Creating userinfo response
2019-06-29 14:40:30.950 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 14:40:30.972 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 14:40:30.984 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 14:40:30.985 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 14:40:30.999 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 14:40:31.003 +01:00 [DBG] End userinfo request
2019-06-29 14:40:31.096 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 14:40:31.106 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 14:40:31.109 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 14:40:31.172 +01:00 [DBG] Rendering check session result
2019-06-29 14:40:49.259 +01:00 [INF] Removing 0 grants
2019-06-29 14:41:19.280 +01:00 [INF] Removing 0 grants
2019-06-29 14:41:49.293 +01:00 [INF] Removing 0 grants
2019-06-29 14:42:19.305 +01:00 [INF] Removing 0 grants
2019-06-29 14:42:49.322 +01:00 [INF] Removing 0 grants
2019-06-29 14:43:19.319 +01:00 [INF] Removing 0 grants
2019-06-29 14:43:49.332 +01:00 [INF] Removing 0 grants
2019-06-29 14:44:19.349 +01:00 [INF] Removing 0 grants
2019-06-29 14:44:49.374 +01:00 [INF] Removing 0 grants
2019-06-29 14:45:19.387 +01:00 [INF] Removing 0 grants
2019-06-29 14:45:49.395 +01:00 [INF] Removing 0 grants
2019-06-29 14:46:19.406 +01:00 [INF] Removing 0 grants
2019-06-29 14:46:49.407 +01:00 [INF] Removing 0 grants
2019-06-29 14:47:19.423 +01:00 [INF] Removing 0 grants
2019-06-29 14:47:49.433 +01:00 [INF] Removing 0 grants
2019-06-29 14:48:19.449 +01:00 [INF] Removing 0 grants
2019-06-29 14:48:49.462 +01:00 [INF] Removing 0 grants
2019-06-29 14:49:19.473 +01:00 [INF] Removing 0 grants
2019-06-29 14:49:49.484 +01:00 [INF] Removing 0 grants
2019-06-29 14:50:19.505 +01:00 [INF] Removing 0 grants
2019-06-29 14:50:49.513 +01:00 [INF] Removing 0 grants
2019-06-29 14:51:19.525 +01:00 [INF] Removing 0 grants
2019-06-29 14:51:49.530 +01:00 [INF] Removing 0 grants
2019-06-29 14:52:19.539 +01:00 [INF] Removing 0 grants
2019-06-29 14:52:49.567 +01:00 [INF] Removing 0 grants
2019-06-29 14:53:19.577 +01:00 [INF] Removing 0 grants
2019-06-29 14:53:49.597 +01:00 [INF] Removing 0 grants
2019-06-29 14:54:19.598 +01:00 [INF] Removing 0 grants
2019-06-29 14:54:49.603 +01:00 [INF] Removing 0 grants
2019-06-29 14:55:19.622 +01:00 [INF] Removing 0 grants
2019-06-29 14:55:49.635 +01:00 [INF] Removing 0 grants
2019-06-29 14:56:19.637 +01:00 [INF] Removing 0 grants
2019-06-29 14:56:49.653 +01:00 [INF] Removing 0 grants
2019-06-29 14:57:19.676 +01:00 [INF] Removing 0 grants
2019-06-29 14:57:49.694 +01:00 [INF] Removing 0 grants
2019-06-29 14:58:19.705 +01:00 [INF] Removing 0 grants
2019-06-29 14:58:49.718 +01:00 [INF] Removing 0 grants
2019-06-29 14:59:19.728 +01:00 [INF] Removing 0 grants
2019-06-29 14:59:49.749 +01:00 [INF] Removing 0 grants
2019-06-29 15:00:19.752 +01:00 [INF] Removing 0 grants
2019-06-29 15:00:49.761 +01:00 [INF] Removing 0 grants
2019-06-29 15:01:19.781 +01:00 [INF] Removing 0 grants
2019-06-29 15:01:49.784 +01:00 [INF] Removing 0 grants
2019-06-29 15:02:19.801 +01:00 [INF] Removing 0 grants
2019-06-29 15:02:49.807 +01:00 [INF] Removing 0 grants
2019-06-29 15:03:19.824 +01:00 [INF] Removing 0 grants
2019-06-29 15:03:49.834 +01:00 [INF] Removing 0 grants
2019-06-29 15:04:19.856 +01:00 [INF] Removing 0 grants
2019-06-29 15:04:49.872 +01:00 [INF] Removing 0 grants
2019-06-29 15:05:19.898 +01:00 [INF] Removing 0 grants
2019-06-29 15:05:49.919 +01:00 [INF] Removing 0 grants
2019-06-29 15:06:19.928 +01:00 [INF] Removing 0 grants
2019-06-29 15:06:49.946 +01:00 [INF] Removing 0 grants
2019-06-29 15:07:19.971 +01:00 [INF] Removing 0 grants
2019-06-29 15:07:49.990 +01:00 [INF] Removing 0 grants
2019-06-29 15:08:19.991 +01:00 [INF] Removing 0 grants
2019-06-29 15:08:49.992 +01:00 [INF] Removing 0 grants
2019-06-29 15:09:20.014 +01:00 [INF] Removing 0 grants
2019-06-29 15:09:50.034 +01:00 [INF] Removing 0 grants
2019-06-29 15:10:20.047 +01:00 [INF] Removing 0 grants
2019-06-29 15:10:50.074 +01:00 [INF] Removing 0 grants
2019-06-29 15:11:20.082 +01:00 [INF] Removing 0 grants
2019-06-29 15:11:50.109 +01:00 [INF] Removing 0 grants
2019-06-29 15:12:20.116 +01:00 [INF] Removing 0 grants
2019-06-29 15:12:50.124 +01:00 [INF] Removing 0 grants
2019-06-29 15:13:20.147 +01:00 [INF] Removing 0 grants
2019-06-29 15:13:50.146 +01:00 [INF] Removing 0 grants
2019-06-29 15:14:20.155 +01:00 [INF] Removing 0 grants
2019-06-29 15:14:50.166 +01:00 [INF] Removing 0 grants
2019-06-29 15:15:20.171 +01:00 [INF] Removing 0 grants
2019-06-29 15:15:50.184 +01:00 [INF] Removing 0 grants
2019-06-29 15:16:20.193 +01:00 [INF] Removing 0 grants
2019-06-29 15:16:50.192 +01:00 [INF] Removing 0 grants
2019-06-29 15:17:18.505 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:17:18.513 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:17:18.514 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:17:18.517 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:17:18.520 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:17:18.534 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:17:18.536 +01:00 [DBG] Start discovery request
2019-06-29 15:17:18.821 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:17:18.829 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:17:18.831 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:17:18.833 +01:00 [DBG] Rendering check session result
2019-06-29 15:17:20.202 +01:00 [INF] Removing 0 grants
2019-06-29 15:17:50.205 +01:00 [INF] Removing 0 grants
2019-06-29 15:18:11.475 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:18:11.700 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:18:11.892 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:18:11.958 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:18:11.980 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:18:11.983 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:18:11.999 +01:00 [DBG] Start discovery request
2019-06-29 15:18:12.314 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:18:12.427 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:18:12.438 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:18:12.474 +01:00 [DBG] Rendering check session result
2019-06-29 15:18:19.888 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:18:20.009 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:18:20.069 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:18:20.109 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:18:20.252 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:18:20.301 +01:00 [INF] Removing 0 grants
2019-06-29 15:18:20.311 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:18:20.314 +01:00 [DBG] Start discovery request
2019-06-29 15:18:20.511 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:18:20.565 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:18:20.594 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:18:20.719 +01:00 [DBG] Rendering check session result
2019-06-29 15:18:50.341 +01:00 [INF] Removing 0 grants
2019-06-29 15:19:20.350 +01:00 [INF] Removing 0 grants
2019-06-29 15:19:24.140 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:19:24.147 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:19:24.150 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:19:24.152 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:19:24.155 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:19:24.158 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:19:24.173 +01:00 [DBG] Start discovery request
2019-06-29 15:19:24.199 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 15:19:24.203 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 15:19:24.231 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 15:19:24.270 +01:00 [DBG] Start authorize request
2019-06-29 15:19:24.288 +01:00 [DBG] No user present in authorize request
2019-06-29 15:19:24.291 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:19:24.313 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:24.362 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:19:24.364 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"d56276c2be274437b4376d3bcda33360","UiLocales":null,"Nonce":"f937f769ea8a4be792005d303db9bfc3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"d56276c2be274437b4376d3bcda33360","nonce":"f937f769ea8a4be792005d303db9bfc3"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 15:19:24.441 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 15:19:24.465 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:19:24.471 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:24.475 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:19:24.477 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:35.182 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 15:19:35.194 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:19:35.194 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:35.207 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:19:35.235 +01:00 [DBG] Augmenting SignInContext
2019-06-29 15:19:35.237 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 15:19:35.247 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 15:19:35.250 +01:00 [DBG] Adding auth_time claim with value: 1561817975
2019-06-29 15:19:35.254 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 15:19:35.259 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:35.284 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 15:19:35.287 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 15:19:35.290 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 15:19:35.293 +01:00 [DBG] Start authorize callback request
2019-06-29 15:19:35.309 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 15:19:35.312 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:19:35.313 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:35.315 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:19:35.318 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"d56276c2be274437b4376d3bcda33360","UiLocales":null,"Nonce":"f937f769ea8a4be792005d303db9bfc3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"09ad42c5ef00916b1c46583ac08cf13b","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"d56276c2be274437b4376d3bcda33360","nonce":"f937f769ea8a4be792005d303db9bfc3"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 15:19:35.371 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 15:19:35.380 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 15:19:35.381 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 15:19:35.382 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 15:19:35.383 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 15:19:35.403 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 15:19:35.412 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 15:19:35.423 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"d56276c2be274437b4376d3bcda33360","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 15:19:35.429 +01:00 [DBG] Augmenting SignInContext
2019-06-29 15:19:35.430 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 15:19:37.236 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:19:37.378 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:19:37.497 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:19:37.504 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:19:37.522 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:19:37.525 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:19:37.536 +01:00 [DBG] Start discovery request
2019-06-29 15:19:37.723 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 15:19:37.761 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:19:37.783 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:19:37.796 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 15:19:37.845 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 15:19:37.933 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 15:19:37.969 +01:00 [DBG] Start key discovery request
2019-06-29 15:19:38.013 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 15:19:38.066 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:19:38.122 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:19:38.136 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 15:19:38.139 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:19:38.160 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:19:38.162 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 15:19:38.164 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 15:19:38.167 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 15:19:38.170 +01:00 [DBG] Start userinfo request
2019-06-29 15:19:38.195 +01:00 [DBG] Bearer token found in header
2019-06-29 15:19:38.235 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:38.241 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:19:38.252 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 15:19:38.256 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561817975,"exp":1561821575,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561817975,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 15:19:38.276 +01:00 [DBG] Creating userinfo response
2019-06-29 15:19:38.277 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:19:38.280 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:19:38.284 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 15:19:38.296 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:19:38.301 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 15:19:38.311 +01:00 [DBG] End userinfo request
2019-06-29 15:19:38.389 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:19:38.441 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:19:38.447 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:19:38.494 +01:00 [DBG] Rendering check session result
2019-06-29 15:19:50.364 +01:00 [INF] Removing 0 grants
2019-06-29 15:20:20.367 +01:00 [INF] Removing 0 grants
2019-06-29 15:20:50.372 +01:00 [INF] Removing 0 grants
2019-06-29 15:21:20.380 +01:00 [INF] Removing 0 grants
2019-06-29 15:21:50.384 +01:00 [INF] Removing 0 grants
2019-06-29 15:22:20.388 +01:00 [INF] Removing 0 grants
2019-06-29 15:22:50.433 +01:00 [INF] Removing 0 grants
2019-06-29 15:22:53.783 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:22:53.946 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:22:54.042 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:22:54.065 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:22:54.143 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:22:54.181 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:22:54.184 +01:00 [DBG] Start discovery request
2019-06-29 15:22:54.313 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:22:54.359 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:22:54.377 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:22:54.388 +01:00 [DBG] Rendering check session result
2019-06-29 15:23:20.460 +01:00 [INF] Removing 0 grants
2019-06-29 15:23:50.473 +01:00 [INF] Removing 0 grants
2019-06-29 15:24:09.325 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:24:09.581 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:24:09.877 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:24:09.971 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:24:10.195 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:24:10.422 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:24:10.526 +01:00 [DBG] Start discovery request
2019-06-29 15:24:10.800 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:24:10.899 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:24:10.915 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:24:10.924 +01:00 [DBG] Rendering check session result
2019-06-29 15:24:19.084 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:24:19.459 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:24:19.795 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:24:19.981 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:24:20.221 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:24:20.348 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:24:20.515 +01:00 [DBG] Start discovery request
2019-06-29 15:24:20.556 +01:00 [INF] Removing 0 grants
2019-06-29 15:24:20.649 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:24:20.690 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:24:20.764 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:24:20.768 +01:00 [DBG] Rendering check session result
2019-06-29 15:24:50.603 +01:00 [INF] Removing 0 grants
2019-06-29 15:25:20.615 +01:00 [INF] Removing 0 grants
2019-06-29 15:25:50.636 +01:00 [INF] Removing 0 grants
2019-06-29 15:26:20.664 +01:00 [INF] Removing 0 grants
2019-06-29 15:26:50.676 +01:00 [INF] Removing 0 grants
2019-06-29 15:27:20.705 +01:00 [INF] Removing 0 grants
2019-06-29 15:27:50.714 +01:00 [INF] Removing 0 grants
2019-06-29 15:28:20.732 +01:00 [INF] Removing 0 grants
2019-06-29 15:28:32.267 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:28:32.388 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:28:32.494 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:28:32.571 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:28:32.709 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:28:32.764 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:28:32.794 +01:00 [DBG] Start discovery request
2019-06-29 15:28:33.040 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:28:33.063 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:28:33.110 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:28:33.149 +01:00 [DBG] Rendering check session result
2019-06-29 15:28:50.739 +01:00 [INF] Removing 0 grants
2019-06-29 15:29:20.744 +01:00 [INF] Removing 0 grants
2019-06-29 15:29:50.761 +01:00 [INF] Removing 0 grants
2019-06-29 15:30:20.819 +01:00 [INF] Removing 0 grants
2019-06-29 15:30:50.837 +01:00 [INF] Removing 0 grants
2019-06-29 15:31:20.863 +01:00 [INF] Removing 0 grants
2019-06-29 15:31:50.863 +01:00 [INF] Removing 0 grants
2019-06-29 15:32:20.869 +01:00 [INF] Removing 0 grants
2019-06-29 15:32:31.466 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:32:31.675 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:32:31.928 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:32:32.011 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:32:32.112 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:32:32.411 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:32:32.467 +01:00 [DBG] Start discovery request
2019-06-29 15:32:32.557 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:32:32.563 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:32:32.565 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:32:32.570 +01:00 [DBG] Rendering check session result
2019-06-29 15:32:50.880 +01:00 [INF] Removing 0 grants
2019-06-29 15:33:20.884 +01:00 [INF] Removing 0 grants
2019-06-29 15:33:50.894 +01:00 [INF] Removing 0 grants
2019-06-29 15:34:21.001 +01:00 [INF] Removing 0 grants
2019-06-29 15:34:51.025 +01:00 [INF] Removing 0 grants
2019-06-29 15:35:10.486 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:35:10.684 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:35:10.885 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:35:10.921 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:35:10.965 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:35:11.027 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:35:11.068 +01:00 [DBG] Start discovery request
2019-06-29 15:35:11.267 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:35:11.342 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:35:11.424 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:35:11.428 +01:00 [DBG] Rendering check session result
2019-06-29 15:35:21.028 +01:00 [INF] Removing 0 grants
2019-06-29 15:35:51.033 +01:00 [INF] Removing 0 grants
2019-06-29 15:36:21.326 +01:00 [INF] Removing 0 grants
2019-06-29 15:36:28.774 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:36:29.023 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:36:29.364 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:36:29.492 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:36:29.774 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:36:30.227 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:36:30.436 +01:00 [DBG] Start discovery request
2019-06-29 15:36:31.089 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:36:31.300 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:36:31.547 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:36:31.783 +01:00 [DBG] Rendering check session result
2019-06-29 15:36:51.364 +01:00 [INF] Removing 0 grants
2019-06-29 15:37:21.379 +01:00 [INF] Removing 0 grants
2019-06-29 15:37:52.885 +01:00 [INF] Removing 0 grants
2019-06-29 15:38:23.354 +01:00 [INF] Removing 0 grants
2019-06-29 15:38:53.639 +01:00 [INF] Removing 0 grants
2019-06-29 15:39:24.157 +01:00 [INF] Removing 0 grants
2019-06-29 15:39:54.400 +01:00 [INF] Removing 0 grants
2019-06-29 15:40:26.700 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:40:27.313 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:40:27.673 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:40:27.744 +01:00 [INF] Removing 0 grants
2019-06-29 15:40:27.813 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:40:28.874 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:40:29.632 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:40:30.169 +01:00 [DBG] Start discovery request
2019-06-29 15:40:36.788 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:40:37.231 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:40:37.841 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:40:38.391 +01:00 [DBG] Rendering check session result
2019-06-29 15:40:58.490 +01:00 [INF] Removing 0 grants
2019-06-29 15:40:58.682 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 15:40:58.701 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 15:40:58.704 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 15:40:58.719 +01:00 [DBG] Start authorize request
2019-06-29 15:40:58.742 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 15:40:58.745 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:40:58.750 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:40:58.800 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:40:58.858 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"21c4b1b32a4541b29f8299efac7dc4f1","UiLocales":null,"Nonce":"1ae72478fd184d28af06a5e0576d827e","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"09ad42c5ef00916b1c46583ac08cf13b","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"21c4b1b32a4541b29f8299efac7dc4f1","nonce":"1ae72478fd184d28af06a5e0576d827e"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 15:40:59.085 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 15:40:59.116 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 15:40:59.120 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 15:40:59.122 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 15:40:59.129 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 15:40:59.242 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 15:40:59.266 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 15:40:59.292 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"21c4b1b32a4541b29f8299efac7dc4f1","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 15:41:05.400 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:41:05.765 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:41:05.933 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:41:05.996 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:41:06.134 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:41:06.370 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:41:06.738 +01:00 [DBG] Start discovery request
2019-06-29 15:41:07.124 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:41:07.160 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:41:07.297 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:41:07.354 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:41:07.555 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:41:08.105 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:41:08.430 +01:00 [DBG] Start discovery request
2019-06-29 15:41:09.705 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:41:09.833 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 15:41:09.957 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:41:10.185 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:41:10.379 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:41:10.381 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:41:10.384 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 15:41:10.388 +01:00 [DBG] Rendering check session result
2019-06-29 15:41:10.400 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 15:41:10.403 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 15:41:10.406 +01:00 [DBG] Start key discovery request
2019-06-29 15:41:11.133 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 15:41:11.481 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:41:11.489 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:41:11.508 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 15:41:11.514 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:41:11.520 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:41:11.523 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 15:41:11.529 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 15:41:11.535 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 15:41:11.540 +01:00 [DBG] Start userinfo request
2019-06-29 15:41:11.543 +01:00 [DBG] Bearer token found in header
2019-06-29 15:41:11.549 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:41:11.554 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:41:12.551 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 15:41:12.624 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561819259,"exp":1561822859,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561817975,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 15:41:12.729 +01:00 [DBG] Creating userinfo response
2019-06-29 15:41:12.767 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:41:12.772 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:41:12.797 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 15:41:12.818 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:41:12.898 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 15:41:12.949 +01:00 [DBG] End userinfo request
2019-06-29 15:41:28.522 +01:00 [INF] Removing 0 grants
2019-06-29 15:41:58.523 +01:00 [INF] Removing 0 grants
2019-06-29 15:42:28.621 +01:00 [INF] Removing 0 grants
2019-06-29 15:43:00.944 +01:00 [INF] Removing 0 grants
2019-06-29 15:43:31.393 +01:00 [INF] Removing 0 grants
2019-06-29 15:44:01.444 +01:00 [INF] Removing 0 grants
2019-06-29 15:44:31.444 +01:00 [INF] Removing 0 grants
2019-06-29 15:44:52.134 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:44:52.145 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:44:52.148 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:44:52.150 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:44:52.152 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:44:52.172 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:44:52.176 +01:00 [DBG] Start discovery request
2019-06-29 15:44:52.315 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:44:52.321 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:44:52.323 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:44:52.325 +01:00 [DBG] Rendering check session result
2019-06-29 15:45:01.441 +01:00 [INF] Removing 0 grants
2019-06-29 15:45:31.456 +01:00 [INF] Removing 0 grants
2019-06-29 15:46:01.470 +01:00 [INF] Removing 0 grants
2019-06-29 15:46:31.475 +01:00 [INF] Removing 0 grants
2019-06-29 15:47:01.491 +01:00 [INF] Removing 0 grants
2019-06-29 15:47:31.493 +01:00 [INF] Removing 0 grants
2019-06-29 15:48:02.241 +01:00 [INF] Removing 0 grants
2019-06-29 15:48:32.370 +01:00 [INF] Removing 0 grants
2019-06-29 15:49:02.377 +01:00 [INF] Removing 0 grants
2019-06-29 15:49:32.388 +01:00 [INF] Removing 0 grants
2019-06-29 15:49:42.000 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:49:42.001 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:49:42.010 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:49:42.011 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:49:42.016 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:49:42.028 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:49:42.030 +01:00 [DBG] Start discovery request
2019-06-29 15:49:42.059 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 15:49:42.061 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 15:49:42.065 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 15:49:42.065 +01:00 [DBG] Start authorize request
2019-06-29 15:49:42.066 +01:00 [DBG] No user present in authorize request
2019-06-29 15:49:42.076 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:49:42.083 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:49:42.092 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:49:42.093 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"cdca2234c0b94713bb9f008b78afda6b","UiLocales":null,"Nonce":"476c61735134429996d07bb0e0ba2ff6","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"cdca2234c0b94713bb9f008b78afda6b","nonce":"476c61735134429996d07bb0e0ba2ff6"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 15:49:42.096 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 15:49:42.116 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:49:42.125 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:49:42.128 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:49:42.129 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:50:02.395 +01:00 [INF] Removing 0 grants
2019-06-29 15:50:04.157 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 15:50:04.171 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:50:04.172 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:50:04.188 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:50:04.339 +01:00 [DBG] Augmenting SignInContext
2019-06-29 15:50:04.401 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 15:50:04.461 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 15:50:04.485 +01:00 [DBG] Adding auth_time claim with value: 1561819804
2019-06-29 15:50:04.490 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 15:50:04.509 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:50:04.593 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 15:50:04.673 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 15:50:04.676 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 15:50:04.704 +01:00 [DBG] Start authorize callback request
2019-06-29 15:50:04.729 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 15:50:04.735 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 15:50:04.750 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:50:04.780 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 15:50:04.794 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"cdca2234c0b94713bb9f008b78afda6b","UiLocales":null,"Nonce":"476c61735134429996d07bb0e0ba2ff6","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"cdca2234c0b94713bb9f008b78afda6b","nonce":"476c61735134429996d07bb0e0ba2ff6"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 15:50:04.951 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 15:50:05.004 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 15:50:05.017 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 15:50:05.020 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 15:50:05.022 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 15:50:05.217 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 15:50:05.260 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 15:50:05.274 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"cdca2234c0b94713bb9f008b78afda6b","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 15:50:05.346 +01:00 [DBG] Augmenting SignInContext
2019-06-29 15:50:05.348 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 15:50:09.110 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:50:09.289 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:50:09.435 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:50:09.534 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:50:09.796 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:50:10.055 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:50:10.275 +01:00 [DBG] Start discovery request
2019-06-29 15:50:10.792 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 15:50:10.862 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:50:10.874 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:50:10.899 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 15:50:10.910 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 15:50:10.929 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 15:50:10.947 +01:00 [DBG] Start key discovery request
2019-06-29 15:50:11.049 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 15:50:11.098 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:50:11.278 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:50:11.514 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 15:50:11.635 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:50:11.719 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:50:11.751 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 15:50:11.817 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 15:50:11.898 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 15:50:11.916 +01:00 [DBG] Start userinfo request
2019-06-29 15:50:11.960 +01:00 [DBG] Bearer token found in header
2019-06-29 15:50:11.993 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:50:12.024 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 15:50:12.134 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 15:50:12.145 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561819805,"exp":1561823405,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561819804,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 15:50:12.382 +01:00 [DBG] Creating userinfo response
2019-06-29 15:50:12.410 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:50:12.553 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:50:12.593 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 15:50:12.600 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 15:50:12.645 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 15:50:12.662 +01:00 [DBG] End userinfo request
2019-06-29 15:50:12.911 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:50:12.924 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:50:12.927 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:50:12.930 +01:00 [DBG] Rendering check session result
2019-06-29 15:50:15.212 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:50:15.273 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:50:15.376 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:50:15.528 +01:00 [DBG] Start discovery request
2019-06-29 15:50:17.293 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 15:50:17.339 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 15:50:17.358 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 15:50:17.364 +01:00 [DBG] Start key discovery request
2019-06-29 15:50:32.426 +01:00 [INF] Removing 0 grants
2019-06-29 15:51:02.434 +01:00 [INF] Removing 0 grants
2019-06-29 15:51:32.458 +01:00 [INF] Removing 0 grants
2019-06-29 15:52:02.492 +01:00 [INF] Removing 0 grants
2019-06-29 15:52:32.503 +01:00 [INF] Removing 0 grants
2019-06-29 15:53:02.505 +01:00 [INF] Removing 0 grants
2019-06-29 15:53:32.532 +01:00 [INF] Removing 0 grants
2019-06-29 15:54:02.546 +01:00 [INF] Removing 0 grants
2019-06-29 15:54:32.760 +01:00 [INF] Removing 0 grants
2019-06-29 15:55:02.891 +01:00 [INF] Removing 0 grants
2019-06-29 15:55:33.323 +01:00 [INF] Removing 0 grants
2019-06-29 15:56:04.049 +01:00 [INF] Removing 0 grants
2019-06-29 15:56:35.739 +01:00 [INF] Removing 0 grants
2019-06-29 15:57:00.180 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 15:57:00.553 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 15:57:01.038 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 15:57:01.207 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 15:57:01.469 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 15:57:01.792 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 15:57:01.908 +01:00 [DBG] Start discovery request
2019-06-29 15:57:04.257 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 15:57:04.659 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 15:57:04.716 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 15:57:04.803 +01:00 [DBG] Rendering check session result
2019-06-29 15:57:09.221 +01:00 [INF] Removing 0 grants
2019-06-29 15:57:39.255 +01:00 [INF] Removing 0 grants
2019-06-29 15:58:09.269 +01:00 [INF] Removing 0 grants
2019-06-29 15:58:40.474 +01:00 [INF] Removing 0 grants
2019-06-29 15:59:11.031 +01:00 [INF] Removing 0 grants
2019-06-29 15:59:41.540 +01:00 [INF] Removing 0 grants
2019-06-29 16:00:11.895 +01:00 [INF] Removing 0 grants
2019-06-29 16:00:34.682 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:00:36.765 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:00:36.888 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:00:37.034 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:00:37.414 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:00:37.793 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:00:38.347 +01:00 [DBG] Start discovery request
2019-06-29 16:00:39.470 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:00:39.716 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:00:40.398 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:00:43.949 +01:00 [DBG] Rendering check session result
2019-06-29 16:00:44.465 +01:00 [INF] Removing 0 grants
2019-06-29 16:01:14.853 +01:00 [INF] Removing 0 grants
2019-06-29 16:01:44.896 +01:00 [INF] Removing 0 grants
2019-06-29 16:02:14.902 +01:00 [INF] Removing 0 grants
2019-06-29 16:02:44.910 +01:00 [INF] Removing 0 grants
2019-06-29 16:03:14.922 +01:00 [INF] Removing 0 grants
2019-06-29 16:03:44.935 +01:00 [INF] Removing 0 grants
2019-06-29 16:04:14.936 +01:00 [INF] Removing 0 grants
2019-06-29 16:04:44.957 +01:00 [INF] Removing 0 grants
2019-06-29 16:05:14.979 +01:00 [INF] Removing 0 grants
2019-06-29 16:05:44.992 +01:00 [INF] Removing 0 grants
2019-06-29 16:06:14.988 +01:00 [INF] Removing 0 grants
2019-06-29 16:06:45.008 +01:00 [INF] Removing 0 grants
2019-06-29 16:07:15.016 +01:00 [INF] Removing 0 grants
2019-06-29 16:07:45.027 +01:00 [INF] Removing 0 grants
2019-06-29 16:08:15.035 +01:00 [INF] Removing 0 grants
2019-06-29 16:08:26.695 +01:00 [DBG] TaskCanceledException. Exiting.
2019-06-29 16:08:26.708 +01:00 [DBG] Stopping grant removal
2019-06-29 16:08:59.264 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 16:08:59.438 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 16:08:59.458 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 16:08:59.460 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 16:08:59.462 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 16:08:59.465 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 16:09:00.283 +01:00 [DBG] Starting grant removal
2019-06-29 16:09:03.439 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 16:09:03.448 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 16:09:03.455 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 16:09:03.459 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 16:09:03.493 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 16:09:03.495 +01:00 [DBG] Error Url: /home/error
2019-06-29 16:09:03.497 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 16:09:30.431 +01:00 [INF] Removing 0 grants
2019-06-29 16:10:00.608 +01:00 [INF] Removing 0 grants
2019-06-29 16:10:03.140 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:10:03.153 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:10:03.155 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:10:03.160 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:10:03.205 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:10:03.209 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:10:03.217 +01:00 [DBG] Start discovery request
2019-06-29 16:10:03.538 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 16:10:03.693 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 16:10:03.721 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 16:10:03.733 +01:00 [DBG] Start authorize request
2019-06-29 16:10:03.755 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 16:10:03.766 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 16:10:03.816 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:10:04.102 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 16:10:04.293 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"9d22a2e8eb86449381beb9f4927d9dd5","UiLocales":null,"Nonce":"6daf7e9b448941cebecb86f482cb19ad","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"9d22a2e8eb86449381beb9f4927d9dd5","nonce":"6daf7e9b448941cebecb86f482cb19ad"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 16:10:05.904 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 16:10:05.934 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 16:10:05.959 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 16:10:06.001 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 16:10:06.047 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 16:10:06.649 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 16:10:06.659 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 16:10:06.715 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"9d22a2e8eb86449381beb9f4927d9dd5","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 16:10:09.720 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:10:09.937 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:10:10.077 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:10:10.161 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:10:10.190 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:10:10.409 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:10:10.526 +01:00 [DBG] Start discovery request
2019-06-29 16:10:10.943 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 16:10:11.035 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:10:11.168 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:10:11.191 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 16:10:11.259 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 16:10:11.366 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 16:10:11.395 +01:00 [DBG] Start key discovery request
2019-06-29 16:10:11.585 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 16:10:11.624 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:10:11.647 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:10:11.697 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 16:10:11.703 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:10:11.727 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:10:11.731 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 16:10:11.761 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 16:10:11.774 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 16:10:11.794 +01:00 [DBG] Start userinfo request
2019-06-29 16:10:11.821 +01:00 [DBG] Bearer token found in header
2019-06-29 16:10:12.177 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:10:12.331 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:10:12.490 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 16:10:12.519 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561821006,"exp":1561824606,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561819804,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 16:10:12.598 +01:00 [DBG] Creating userinfo response
2019-06-29 16:10:12.614 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:10:12.635 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:10:12.679 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 16:10:12.705 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:10:12.754 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 16:10:12.767 +01:00 [DBG] End userinfo request
2019-06-29 16:10:13.014 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:10:13.037 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:10:13.041 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:10:13.047 +01:00 [DBG] Rendering check session result
2019-06-29 16:10:13.870 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:10:13.907 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:10:13.954 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:10:13.964 +01:00 [DBG] Start discovery request
2019-06-29 16:10:14.149 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 16:10:14.167 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 16:10:14.190 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 16:10:14.191 +01:00 [DBG] Start key discovery request
2019-06-29 16:10:30.876 +01:00 [INF] Removing 0 grants
2019-06-29 16:11:00.920 +01:00 [INF] Removing 0 grants
2019-06-29 16:11:30.966 +01:00 [INF] Removing 0 grants
2019-06-29 16:12:01.039 +01:00 [INF] Removing 0 grants
2019-06-29 16:12:31.127 +01:00 [INF] Removing 0 grants
2019-06-29 16:13:01.156 +01:00 [INF] Removing 0 grants
2019-06-29 16:15:06.575 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 16:15:06.655 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 16:15:06.656 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 16:15:06.657 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 16:15:06.658 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 16:15:06.659 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 16:15:07.334 +01:00 [DBG] Starting grant removal
2019-06-29 16:15:11.403 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 16:15:11.432 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 16:15:11.441 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 16:15:11.444 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 16:15:11.487 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 16:15:11.544 +01:00 [DBG] Error Url: /home/error
2019-06-29 16:15:11.617 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 16:15:37.484 +01:00 [INF] Removing 0 grants
2019-06-29 16:16:07.491 +01:00 [INF] Removing 0 grants
2019-06-29 16:16:25.094 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:16:25.107 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:16:25.121 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:16:25.132 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:16:25.142 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:16:25.151 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:16:25.158 +01:00 [DBG] Start discovery request
2019-06-29 16:16:25.370 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 16:16:25.406 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 16:16:25.416 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 16:16:25.437 +01:00 [DBG] Start authorize request
2019-06-29 16:16:25.455 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 16:16:25.464 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 16:16:25.510 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:16:25.581 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 16:16:25.660 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"3f2d757f7eec4043941605bb45583045","UiLocales":null,"Nonce":"d093c5401fff4c6797fdd24c4a0add42","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"3f2d757f7eec4043941605bb45583045","nonce":"d093c5401fff4c6797fdd24c4a0add42"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 16:16:26.736 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 16:16:26.761 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 16:16:26.795 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 16:16:26.829 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 16:16:26.831 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 16:16:27.999 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 16:16:28.011 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 16:16:28.306 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"3f2d757f7eec4043941605bb45583045","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 16:16:31.442 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:16:31.555 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:16:31.593 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:16:31.665 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:16:31.780 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:16:31.945 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:16:31.993 +01:00 [DBG] Start discovery request
2019-06-29 16:16:33.222 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 16:16:33.271 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:16:33.357 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:16:33.377 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 16:16:33.435 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 16:16:33.452 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 16:16:33.481 +01:00 [DBG] Start key discovery request
2019-06-29 16:16:33.707 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 16:16:33.847 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:16:33.872 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:16:33.948 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 16:16:34.004 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:16:34.046 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:16:34.078 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 16:16:34.117 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 16:16:34.120 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 16:16:34.233 +01:00 [DBG] Start userinfo request
2019-06-29 16:16:34.262 +01:00 [DBG] Bearer token found in header
2019-06-29 16:16:34.523 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:16:34.544 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:16:34.579 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 16:16:34.593 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561821387,"exp":1561824987,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561819804,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 16:16:34.659 +01:00 [DBG] Creating userinfo response
2019-06-29 16:16:34.696 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:16:34.732 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:16:34.743 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 16:16:34.755 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:16:34.777 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 16:16:34.781 +01:00 [DBG] End userinfo request
2019-06-29 16:16:34.942 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:16:35.119 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:16:35.193 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:16:35.260 +01:00 [DBG] Rendering check session result
2019-06-29 16:16:36.668 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:16:36.700 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:16:36.778 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:16:36.797 +01:00 [DBG] Start discovery request
2019-06-29 16:16:37.282 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 16:16:37.313 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 16:16:37.388 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 16:16:37.418 +01:00 [DBG] Start key discovery request
2019-06-29 16:16:37.692 +01:00 [INF] Removing 0 grants
2019-06-29 16:17:07.820 +01:00 [INF] Removing 0 grants
2019-06-29 16:17:37.838 +01:00 [INF] Removing 0 grants
2019-06-29 16:18:07.888 +01:00 [INF] Removing 0 grants
2019-06-29 16:18:37.899 +01:00 [INF] Removing 0 grants
2019-06-29 16:19:07.904 +01:00 [INF] Removing 0 grants
2019-06-29 16:19:37.912 +01:00 [INF] Removing 0 grants
2019-06-29 16:20:07.921 +01:00 [INF] Removing 0 grants
2019-06-29 16:20:38.042 +01:00 [INF] Removing 0 grants
2019-06-29 16:20:58.283 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:20:58.341 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:20:58.363 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:20:58.402 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:20:58.457 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:20:58.466 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:20:58.522 +01:00 [DBG] Start discovery request
2019-06-29 16:21:00.153 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:21:00.161 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:21:00.190 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:21:00.197 +01:00 [DBG] Rendering check session result
2019-06-29 16:21:08.106 +01:00 [INF] Removing 0 grants
2019-06-29 16:21:38.133 +01:00 [INF] Removing 0 grants
2019-06-29 16:22:08.186 +01:00 [INF] Removing 0 grants
2019-06-29 16:22:34.438 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:22:34.806 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:22:35.489 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:22:36.145 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:22:36.451 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:22:37.118 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:22:37.890 +01:00 [DBG] Start discovery request
2019-06-29 16:22:40.006 +01:00 [INF] Removing 0 grants
2019-06-29 16:22:40.957 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:22:40.973 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:22:41.025 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:22:41.058 +01:00 [DBG] Rendering check session result
2019-06-29 16:22:54.169 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:22:54.341 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:22:54.441 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:22:54.462 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:22:54.486 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:22:54.589 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:22:54.688 +01:00 [DBG] Start discovery request
2019-06-29 16:22:55.117 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:22:55.230 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:22:55.507 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:22:55.699 +01:00 [DBG] Rendering check session result
2019-06-29 16:22:59.232 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 16:22:59.272 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 16:22:59.324 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 16:22:59.441 +01:00 [DBG] Start authorize request
2019-06-29 16:22:59.472 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 16:22:59.700 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 16:22:59.789 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:22:59.860 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 16:22:59.891 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"7a5c50757bec40d7980d7d976022d273","UiLocales":null,"Nonce":"654d2adc58f640269847e814c75f94cb","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"7a5c50757bec40d7980d7d976022d273","nonce":"654d2adc58f640269847e814c75f94cb"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 16:23:00.510 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 16:23:00.585 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 16:23:00.789 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 16:23:00.811 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 16:23:00.887 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 16:23:01.285 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 16:23:01.467 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 16:23:01.740 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"7a5c50757bec40d7980d7d976022d273","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 16:23:10.592 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:23:11.113 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:23:11.526 +01:00 [INF] Removing 0 grants
2019-06-29 16:23:11.647 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:23:12.408 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:23:12.586 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:23:13.037 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:23:13.415 +01:00 [DBG] Start discovery request
2019-06-29 16:23:14.292 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 16:23:14.677 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:23:15.388 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 16:23:15.545 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:23:15.576 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 16:23:15.583 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 16:23:15.804 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 16:23:15.815 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 16:23:15.839 +01:00 [DBG] Rendering check session result
2019-06-29 16:23:15.848 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 16:23:16.001 +01:00 [DBG] Start discovery request
2019-06-29 16:23:16.404 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 16:23:16.581 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:23:16.653 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:23:16.661 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 16:23:16.726 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 16:23:16.809 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 16:23:16.884 +01:00 [DBG] Start key discovery request
2019-06-29 16:23:17.201 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 16:23:17.259 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:23:17.309 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:23:17.377 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 16:23:17.384 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 16:23:17.407 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 16:23:17.423 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 16:23:17.436 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 16:23:17.564 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 16:23:17.651 +01:00 [DBG] Start userinfo request
2019-06-29 16:23:17.694 +01:00 [DBG] Bearer token found in header
2019-06-29 16:23:17.712 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:23:17.717 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 16:23:18.609 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 16:23:18.986 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561821781,"exp":1561825381,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561819804,"idp":"local","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 16:23:19.972 +01:00 [DBG] Creating userinfo response
2019-06-29 16:23:19.996 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:23:20.107 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:23:20.252 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 16:23:20.309 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 16:23:21.505 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website role preferred_username
2019-06-29 16:23:21.536 +01:00 [DBG] End userinfo request
2019-06-29 16:23:42.206 +01:00 [INF] Removing 0 grants
2019-06-29 16:24:12.216 +01:00 [INF] Removing 0 grants
2019-06-29 16:24:42.242 +01:00 [INF] Removing 0 grants
2019-06-29 16:25:12.252 +01:00 [INF] Removing 0 grants
2019-06-29 16:25:42.279 +01:00 [INF] Removing 0 grants
2019-06-29 16:26:12.300 +01:00 [INF] Removing 0 grants
2019-06-29 16:26:42.310 +01:00 [INF] Removing 0 grants
2019-06-29 21:57:16.976 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 21:57:17.015 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 21:57:17.016 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 21:57:17.016 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 21:57:17.018 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 21:57:17.019 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 21:57:17.251 +01:00 [DBG] Starting grant removal
2019-06-29 21:57:19.002 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 21:57:19.045 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 21:57:19.110 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 21:57:19.130 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 21:57:19.169 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 21:57:19.275 +01:00 [DBG] Error Url: /home/error
2019-06-29 21:57:19.308 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 21:57:47.300 +01:00 [INF] Removing 0 grants
2019-06-29 21:58:17.340 +01:00 [INF] Removing 0 grants
2019-06-29 21:58:47.337 +01:00 [INF] Removing 0 grants
2019-06-29 21:59:17.351 +01:00 [INF] Removing 0 grants
2019-06-29 21:59:47.365 +01:00 [INF] Removing 0 grants
2019-06-29 22:02:11.881 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 22:02:11.954 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 22:02:11.956 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 22:02:11.956 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 22:02:11.957 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 22:02:11.959 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 22:02:12.180 +01:00 [DBG] Starting grant removal
2019-06-29 22:02:13.804 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 22:02:13.809 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 22:02:13.810 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 22:02:13.810 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 22:02:13.835 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 22:02:13.837 +01:00 [DBG] Error Url: /home/error
2019-06-29 22:02:13.839 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 22:02:28.823 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:02:28.852 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:02:28.854 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:02:28.879 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:02:28.905 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:02:28.906 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:02:28.916 +01:00 [DBG] Start discovery request
2019-06-29 22:02:29.107 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:02:29.149 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:02:29.175 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:02:29.201 +01:00 [DBG] Start authorize request
2019-06-29 22:02:29.254 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:02:29.272 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:02:29.310 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:02:29.515 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:02:29.555 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"c6a19899ca304d909fb6ccd73bdc80b0","UiLocales":null,"Nonce":"423d49c8642548109887cac88a73dc5d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"c6a19899ca304d909fb6ccd73bdc80b0","nonce":"423d49c8642548109887cac88a73dc5d"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:02:31.238 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:02:31.323 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:02:31.543 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:02:31.643 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:02:31.670 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:02:32.883 +01:00 [FTL] Unhandled exception: Value cannot be null.
Parameter name: value
System.ArgumentNullException: Value cannot be null.
Parameter name: value
   at System.Security.Claims.Claim..ctor(String type, String value, String valueType, String issuer, String originalIssuer, ClaimsIdentity subject, String propertyKey, String propertyValue)
   at System.Security.Claims.Claim..ctor(String type, String value)
   at IdentityServer4AspNetIdentity.Service.IdentityClaimsProfileService.GetProfileDataAsync(ProfileDataRequestContext context) in C:\Users\Odumosu\Downloads\IdentityServer4.Templates-master\IdentityServer4.Templates-master\src\IdentityServer4AspNetIdentity\Service\IdentityClaimsProfileService.cs:line 30
   at IdentityServer4.Services.DefaultClaimsService.GetAccessTokenClaimsAsync(ClaimsPrincipal subject, Resources resources, ValidatedRequest request) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultClaimsService.cs:line 212
   at IdentityServer4.Services.DefaultTokenService.CreateAccessTokenAsync(TokenCreationRequest request) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenService.cs:line 159
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateImplicitFlowResponseAsync(ValidatedAuthorizeRequest request, String authorizationCode) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 154
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateResponseAsync(ValidatedAuthorizeRequest request) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 81
   at IdentityServer4.Endpoints.AuthorizeEndpointBase.ProcessAuthorizeRequestAsync(NameValueCollection parameters, ClaimsPrincipal user, ConsentResponse consent) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpointBase.cs:line 99
   at IdentityServer4.Endpoints.AuthorizeEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpoint.cs:line 55
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
2019-06-29 22:02:33.037 +01:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null.
Parameter name: value
   at System.Security.Claims.Claim..ctor(String type, String value, String valueType, String issuer, String originalIssuer, ClaimsIdentity subject, String propertyKey, String propertyValue)
   at System.Security.Claims.Claim..ctor(String type, String value)
   at IdentityServer4AspNetIdentity.Service.IdentityClaimsProfileService.GetProfileDataAsync(ProfileDataRequestContext context) in C:\Users\Odumosu\Downloads\IdentityServer4.Templates-master\IdentityServer4.Templates-master\src\IdentityServer4AspNetIdentity\Service\IdentityClaimsProfileService.cs:line 30
   at IdentityServer4.Services.DefaultClaimsService.GetAccessTokenClaimsAsync(ClaimsPrincipal subject, Resources resources, ValidatedRequest request) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultClaimsService.cs:line 212
   at IdentityServer4.Services.DefaultTokenService.CreateAccessTokenAsync(TokenCreationRequest request) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultTokenService.cs:line 159
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateImplicitFlowResponseAsync(ValidatedAuthorizeRequest request, String authorizationCode) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 154
   at IdentityServer4.ResponseHandling.AuthorizeResponseGenerator.CreateResponseAsync(ValidatedAuthorizeRequest request) in C:\local\identity\server4\IdentityServer4\src\ResponseHandling\Default\AuthorizeResponseGenerator.cs:line 81
   at IdentityServer4.Endpoints.AuthorizeEndpointBase.ProcessAuthorizeRequestAsync(NameValueCollection parameters, ClaimsPrincipal user, ConsentResponse consent) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpointBase.cs:line 99
   at IdentityServer4.Endpoints.AuthorizeEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\AuthorizeEndpoint.cs:line 55
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-29 22:02:42.260 +01:00 [INF] Removing 0 grants
2019-06-29 22:03:12.266 +01:00 [INF] Removing 0 grants
2019-06-29 22:03:42.283 +01:00 [INF] Removing 0 grants
2019-06-29 22:03:55.903 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:03:55.915 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:03:55.918 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:03:55.919 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:03:55.924 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:03:55.989 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:03:56.024 +01:00 [DBG] Start discovery request
2019-06-29 22:03:56.108 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:03:56.141 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:03:56.203 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:03:56.216 +01:00 [DBG] Start authorize request
2019-06-29 22:03:56.225 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:03:56.226 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:03:56.235 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:03:56.238 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:03:56.241 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"3bdc5b0db38d427c8f3425cf452fa16f","UiLocales":null,"Nonce":"c183ecf3dc3a4a289ed77844b6bd8ada","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"3bdc5b0db38d427c8f3425cf452fa16f","nonce":"c183ecf3dc3a4a289ed77844b6bd8ada"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:03:56.310 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:03:56.350 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:03:56.366 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:03:56.369 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:03:56.373 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:08:14.356 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 22:08:14.399 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 22:08:14.400 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 22:08:14.400 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 22:08:14.401 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 22:08:14.402 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 22:08:14.642 +01:00 [DBG] Starting grant removal
2019-06-29 22:08:16.014 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 22:08:16.036 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 22:08:16.037 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 22:08:16.039 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 22:08:16.041 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 22:08:16.043 +01:00 [DBG] Error Url: /home/error
2019-06-29 22:08:16.045 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 22:08:44.779 +01:00 [INF] Removing 0 grants
2019-06-29 22:09:14.819 +01:00 [INF] Removing 0 grants
2019-06-29 22:09:37.207 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:09:37.218 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:09:37.222 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:09:37.250 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:09:37.297 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:09:37.298 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:09:37.306 +01:00 [DBG] Start discovery request
2019-06-29 22:09:37.475 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:09:37.480 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:09:37.485 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:09:37.503 +01:00 [DBG] Start authorize request
2019-06-29 22:09:37.531 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:09:37.538 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:09:37.566 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:09:37.639 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:09:37.673 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"189c608f475045c18d42d2e594b53dad","UiLocales":null,"Nonce":"7be30215a36c425cb071f8ca0ae5eb44","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"126a4fd5ecdd7e4243dff785b43ebe78","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"189c608f475045c18d42d2e594b53dad","nonce":"7be30215a36c425cb071f8ca0ae5eb44"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:09:38.597 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:09:38.733 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:09:38.787 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:09:38.849 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:09:38.859 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:09:52.211 +01:00 [INF] Removing 0 grants
2019-06-29 22:10:02.342 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 22:10:03.159 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 22:10:03.163 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 22:10:03.271 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"189c608f475045c18d42d2e594b53dad","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 22:10:07.988 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:10:08.019 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:10:08.119 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:10:08.131 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:10:08.156 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:10:08.213 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:10:08.456 +01:00 [DBG] Start discovery request
2019-06-29 22:10:08.586 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 22:10:08.593 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:10:08.598 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:10:08.629 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:10:08.636 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:10:08.638 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:10:08.660 +01:00 [DBG] Start key discovery request
2019-06-29 22:10:08.840 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:10:08.893 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:10:08.896 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:10:08.915 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:10:08.916 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:10:08.917 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:10:08.918 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 22:10:08.926 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 22:10:08.928 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 22:10:08.948 +01:00 [DBG] Start userinfo request
2019-06-29 22:10:08.954 +01:00 [DBG] Bearer token found in header
2019-06-29 22:10:09.059 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:10:09.116 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:10:09.164 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 22:10:09.178 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561842602,"exp":1561846202,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561819804,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 22:10:09.230 +01:00 [DBG] Creating userinfo response
2019-06-29 22:10:09.271 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:10:09.297 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:10:09.319 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 22:10:09.346 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:10:09.384 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 22:10:09.385 +01:00 [DBG] End userinfo request
2019-06-29 22:10:09.466 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:10:09.534 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:10:09.563 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:10:09.575 +01:00 [DBG] Rendering check session result
2019-06-29 22:10:10.519 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:10:10.539 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:10:10.590 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:10:10.594 +01:00 [DBG] Start discovery request
2019-06-29 22:10:10.904 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:10:10.906 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:10:10.907 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:10:10.908 +01:00 [DBG] Start key discovery request
2019-06-29 22:10:22.239 +01:00 [INF] Removing 0 grants
2019-06-29 22:10:52.259 +01:00 [INF] Removing 0 grants
2019-06-29 22:11:22.274 +01:00 [INF] Removing 0 grants
2019-06-29 22:11:52.285 +01:00 [INF] Removing 0 grants
2019-06-29 22:12:22.298 +01:00 [INF] Removing 0 grants
2019-06-29 22:12:47.470 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:12:47.563 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:12:47.666 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:12:47.754 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:12:47.991 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:12:48.158 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:12:48.315 +01:00 [DBG] Start discovery request
2019-06-29 22:12:49.298 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:12:49.307 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:12:49.331 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:12:49.376 +01:00 [DBG] Rendering check session result
2019-06-29 22:12:52.308 +01:00 [INF] Removing 0 grants
2019-06-29 22:13:22.504 +01:00 [INF] Removing 0 grants
2019-06-29 22:13:32.519 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:13:32.525 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:13:32.528 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:13:32.528 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:13:32.530 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:13:32.531 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:13:32.538 +01:00 [DBG] Start discovery request
2019-06-29 22:13:32.630 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:13:32.648 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:13:32.665 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:13:32.670 +01:00 [DBG] Start authorize request
2019-06-29 22:13:32.672 +01:00 [DBG] No user present in authorize request
2019-06-29 22:13:32.675 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:13:32.677 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:13:32.679 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:13:32.682 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"02b665bf027f416182a2b248450778ac","UiLocales":null,"Nonce":"543167bac08e4373b5da173d583e95cb","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"02b665bf027f416182a2b248450778ac","nonce":"543167bac08e4373b5da173d583e95cb"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:13:32.698 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 22:13:32.956 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:13:32.957 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:13:32.958 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:13:32.966 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:13:52.601 +01:00 [INF] Removing 0 grants
2019-06-29 22:13:55.139 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 22:13:55.298 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:13:55.308 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:13:55.320 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:13:55.648 +01:00 [DBG] Augmenting SignInContext
2019-06-29 22:13:55.653 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 22:13:55.654 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 22:13:55.656 +01:00 [DBG] Adding auth_time claim with value: 1561842835
2019-06-29 22:13:55.669 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 22:13:55.681 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:13:55.715 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 22:13:55.717 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 22:13:55.718 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 22:13:55.728 +01:00 [DBG] Start authorize callback request
2019-06-29 22:13:55.743 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:13:55.746 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:13:55.747 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:13:55.749 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:13:55.755 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"02b665bf027f416182a2b248450778ac","UiLocales":null,"Nonce":"543167bac08e4373b5da173d583e95cb","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"741ae4ae1e257cc388fb0f20235dd25f","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"02b665bf027f416182a2b248450778ac","nonce":"543167bac08e4373b5da173d583e95cb"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:13:55.810 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:13:55.820 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:13:55.825 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:13:55.825 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:13:55.826 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:13:55.833 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 22:13:55.848 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 22:13:55.850 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 22:13:55.857 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"02b665bf027f416182a2b248450778ac","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 22:13:55.869 +01:00 [DBG] Augmenting SignInContext
2019-06-29 22:13:55.871 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 22:13:58.551 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:13:58.811 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:13:58.972 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:13:59.028 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:13:59.165 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:13:59.341 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:13:59.691 +01:00 [DBG] Start discovery request
2019-06-29 22:14:00.672 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 22:14:00.674 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:14:00.674 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:14:00.676 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:14:00.680 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:14:00.693 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:14:00.724 +01:00 [DBG] Start key discovery request
2019-06-29 22:14:00.866 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:14:00.879 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:14:00.893 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:14:00.951 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:14:00.963 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:14:01.080 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:14:01.083 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 22:14:01.129 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 22:14:01.255 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 22:14:01.259 +01:00 [DBG] Start userinfo request
2019-06-29 22:14:01.260 +01:00 [DBG] Bearer token found in header
2019-06-29 22:14:01.262 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:14:01.268 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:14:01.277 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 22:14:01.278 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561842835,"exp":1561846435,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561842835,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 22:14:01.288 +01:00 [DBG] Creating userinfo response
2019-06-29 22:14:01.289 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:14:01.293 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:14:01.293 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 22:14:01.295 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:14:01.299 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 22:14:01.300 +01:00 [DBG] End userinfo request
2019-06-29 22:14:01.674 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:14:01.709 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:14:01.712 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:14:01.716 +01:00 [DBG] Rendering check session result
2019-06-29 22:14:22.642 +01:00 [INF] Removing 0 grants
2019-06-29 22:14:52.662 +01:00 [INF] Removing 0 grants
2019-06-29 22:15:22.674 +01:00 [INF] Removing 0 grants
2019-06-29 22:15:52.690 +01:00 [INF] Removing 0 grants
2019-06-29 22:16:23.049 +01:00 [INF] Removing 0 grants
2019-06-29 22:16:23.466 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:16:23.911 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:16:24.181 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:16:24.268 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:16:24.425 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:16:24.570 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:16:24.734 +01:00 [DBG] Start discovery request
2019-06-29 22:16:25.039 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:16:25.040 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:16:25.058 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:16:25.060 +01:00 [DBG] Rendering check session result
2019-06-29 22:16:47.877 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:16:48.192 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:16:48.352 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:16:48.377 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:16:48.412 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:16:48.527 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:16:48.623 +01:00 [DBG] Start discovery request
2019-06-29 22:16:49.161 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:16:49.239 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:16:49.395 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:16:49.429 +01:00 [DBG] Rendering check session result
2019-06-29 22:16:53.092 +01:00 [INF] Removing 0 grants
2019-06-29 22:16:58.890 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:16:59.294 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:16:59.315 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:16:59.324 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:16:59.344 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:16:59.351 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:16:59.362 +01:00 [DBG] Start discovery request
2019-06-29 22:16:59.558 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:16:59.579 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:16:59.607 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:16:59.627 +01:00 [DBG] Rendering check session result
2019-06-29 22:17:01.420 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:17:01.425 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:17:01.470 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:17:01.472 +01:00 [DBG] Start authorize request
2019-06-29 22:17:01.475 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:17:01.478 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:17:01.479 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:17:01.480 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:17:01.480 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"cb3414ffaf42417382def2ede13ca33d","UiLocales":null,"Nonce":"35320dca5a464c518dadd0aa96fc8366","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"741ae4ae1e257cc388fb0f20235dd25f","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"cb3414ffaf42417382def2ede13ca33d","nonce":"35320dca5a464c518dadd0aa96fc8366"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:17:01.503 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:17:01.520 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:17:01.524 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:17:01.526 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:17:01.531 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:17:01.543 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 22:17:01.553 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 22:17:01.555 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 22:17:01.565 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"cb3414ffaf42417382def2ede13ca33d","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 22:17:04.379 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:17:04.551 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:17:04.685 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:17:04.771 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:17:04.863 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:17:04.996 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:17:05.031 +01:00 [DBG] Start discovery request
2019-06-29 22:17:05.148 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:17:05.197 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:17:05.222 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:17:05.236 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:17:05.238 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:17:05.239 +01:00 [DBG] Rendering check session result
2019-06-29 22:17:05.252 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:17:05.264 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:17:05.285 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:17:05.427 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:17:05.456 +01:00 [DBG] Start discovery request
2019-06-29 22:17:05.490 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 22:17:05.493 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:17:05.494 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:17:05.495 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:17:05.500 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:17:05.502 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:17:05.505 +01:00 [DBG] Start key discovery request
2019-06-29 22:17:05.552 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:17:05.553 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:17:05.557 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:17:05.563 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:17:05.564 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:17:05.565 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:17:05.565 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 22:17:05.566 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 22:17:05.569 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 22:17:05.569 +01:00 [DBG] Start userinfo request
2019-06-29 22:17:05.570 +01:00 [DBG] Bearer token found in header
2019-06-29 22:17:05.571 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:17:05.572 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:17:05.590 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 22:17:05.591 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561843021,"exp":1561846621,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561842835,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 22:17:05.597 +01:00 [DBG] Creating userinfo response
2019-06-29 22:17:05.603 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:17:05.612 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:17:05.613 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 22:17:05.614 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:17:05.623 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 22:17:05.625 +01:00 [DBG] End userinfo request
2019-06-29 22:17:23.101 +01:00 [INF] Removing 0 grants
2019-06-29 22:17:53.198 +01:00 [INF] Removing 0 grants
2019-06-29 22:18:02.766 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:18:02.770 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:18:02.772 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:18:02.773 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:18:02.776 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:18:02.778 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:18:02.780 +01:00 [DBG] Start discovery request
2019-06-29 22:18:02.900 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:18:02.901 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:18:02.906 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:18:02.919 +01:00 [DBG] Start authorize request
2019-06-29 22:18:02.920 +01:00 [DBG] No user present in authorize request
2019-06-29 22:18:02.924 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:18:02.925 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:02.926 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:18:02.927 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"6823683fa306452985fafeee8d9bf642","UiLocales":null,"Nonce":"889d1cf205c04948a7920e432ff303a0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"6823683fa306452985fafeee8d9bf642","nonce":"889d1cf205c04948a7920e432ff303a0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:18:02.949 +01:00 [INF] Showing login: User is not authenticated
2019-06-29 22:18:03.030 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:18:03.043 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:03.084 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:18:03.093 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:19.104 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-29 22:18:19.106 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:18:19.112 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:19.114 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:18:19.231 +01:00 [DBG] Augmenting SignInContext
2019-06-29 22:18:19.231 +01:00 [DBG] Adding idp claim with value: local
2019-06-29 22:18:19.232 +01:00 [DBG] Adding amr claim with value: pwd
2019-06-29 22:18:19.233 +01:00 [DBG] Adding auth_time claim with value: 1561843099
2019-06-29 22:18:19.246 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 22:18:19.254 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:19.287 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-29 22:18:19.302 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-29 22:18:19.368 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-29 22:18:19.400 +01:00 [DBG] Start authorize callback request
2019-06-29 22:18:19.407 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:18:19.411 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:18:19.412 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:19.413 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:18:19.417 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"6823683fa306452985fafeee8d9bf642","UiLocales":null,"Nonce":"889d1cf205c04948a7920e432ff303a0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"99ff52ec6887c7540542fcac11062dd8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"6823683fa306452985fafeee8d9bf642","nonce":"889d1cf205c04948a7920e432ff303a0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:18:19.489 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:18:19.495 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:18:19.509 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:18:19.510 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:18:19.515 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:18:19.520 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 22:18:19.535 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 22:18:19.538 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 22:18:19.549 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"6823683fa306452985fafeee8d9bf642","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 22:18:19.553 +01:00 [DBG] Augmenting SignInContext
2019-06-29 22:18:19.554 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-29 22:18:23.000 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:18:23.055 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:18:23.087 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:18:23.092 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:18:23.103 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:18:23.124 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:18:23.134 +01:00 [DBG] Start discovery request
2019-06-29 22:18:23.236 +01:00 [INF] Removing 0 grants
2019-06-29 22:18:23.310 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 22:18:23.357 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:18:23.474 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:18:23.496 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:18:23.548 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:18:23.552 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:18:23.553 +01:00 [DBG] Start key discovery request
2019-06-29 22:18:23.721 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:18:23.806 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:18:23.813 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:18:23.820 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:18:23.821 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:18:23.822 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:18:23.823 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 22:18:23.825 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 22:18:23.827 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 22:18:23.828 +01:00 [DBG] Start userinfo request
2019-06-29 22:18:23.839 +01:00 [DBG] Bearer token found in header
2019-06-29 22:18:23.842 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:23.849 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:18:23.898 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 22:18:23.902 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561843099,"exp":1561846699,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561843099,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 22:18:23.933 +01:00 [DBG] Creating userinfo response
2019-06-29 22:18:23.939 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:18:23.942 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:18:23.945 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 22:18:23.947 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:18:23.988 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 22:18:23.991 +01:00 [DBG] End userinfo request
2019-06-29 22:18:24.133 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:18:24.193 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:18:24.238 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:18:24.251 +01:00 [DBG] Rendering check session result
2019-06-29 22:18:53.284 +01:00 [INF] Removing 0 grants
2019-06-29 22:19:23.290 +01:00 [INF] Removing 0 grants
2019-06-29 22:19:53.308 +01:00 [INF] Removing 0 grants
2019-06-29 22:20:23.311 +01:00 [INF] Removing 0 grants
2019-06-29 22:20:53.314 +01:00 [INF] Removing 0 grants
2019-06-29 22:21:23.368 +01:00 [INF] Removing 0 grants
2019-06-29 22:21:53.363 +01:00 [INF] Removing 0 grants
2019-06-29 22:22:23.406 +01:00 [INF] Removing 0 grants
2019-06-29 22:22:53.431 +01:00 [INF] Removing 0 grants
2019-06-29 22:23:23.451 +01:00 [INF] Removing 0 grants
2019-06-29 22:35:30.359 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 22:35:30.431 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 22:35:30.432 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 22:35:30.432 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 22:35:30.433 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 22:35:30.434 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 22:35:30.632 +01:00 [DBG] Starting grant removal
2019-06-29 22:35:33.279 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 22:35:33.351 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 22:35:33.357 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 22:35:33.380 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 22:35:33.387 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 22:35:33.404 +01:00 [DBG] Error Url: /home/error
2019-06-29 22:35:33.410 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 22:36:01.102 +01:00 [INF] Removing 0 grants
2019-06-29 22:36:27.562 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:36:27.574 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:36:27.576 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:36:27.589 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:36:27.595 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:36:27.597 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:36:27.602 +01:00 [DBG] Start discovery request
2019-06-29 22:36:27.773 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 22:36:27.802 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 22:36:27.963 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 22:36:28.013 +01:00 [DBG] Start authorize request
2019-06-29 22:36:28.050 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:36:28.093 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 22:36:28.243 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:36:28.451 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 22:36:28.560 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"6381b090b7424fd1821a1212dbf1cc46","UiLocales":null,"Nonce":"cd78dbb2f60742c4a9717406b1d3bc47","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"99ff52ec6887c7540542fcac11062dd8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"6381b090b7424fd1821a1212dbf1cc46","nonce":"cd78dbb2f60742c4a9717406b1d3bc47"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 22:36:30.361 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 22:36:30.450 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 22:36:30.570 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 22:36:30.606 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 22:36:30.689 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 22:36:30.932 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 22:36:31.196 +01:00 [INF] Removing 0 grants
2019-06-29 22:36:31.654 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 22:36:31.700 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 22:36:31.760 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"6381b090b7424fd1821a1212dbf1cc46","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 22:36:34.512 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 22:36:34.638 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:36:34.811 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:36:34.871 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:36:34.944 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:36:35.103 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:36:35.135 +01:00 [DBG] Start discovery request
2019-06-29 22:36:35.367 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 22:36:35.447 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:36:35.515 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:36:35.538 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:36:35.636 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:36:35.677 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:36:35.684 +01:00 [DBG] Start key discovery request
2019-06-29 22:36:35.774 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:36:35.830 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:36:35.838 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:36:35.869 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 22:36:35.872 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 22:36:35.876 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 22:36:35.877 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 22:36:35.882 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 22:36:35.884 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 22:36:35.898 +01:00 [DBG] Start userinfo request
2019-06-29 22:36:35.904 +01:00 [DBG] Bearer token found in header
2019-06-29 22:36:35.977 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:36:35.986 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 22:36:36.028 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 22:36:36.038 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561844191,"exp":1561847791,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561843099,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 22:36:36.055 +01:00 [DBG] Creating userinfo response
2019-06-29 22:36:36.060 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:36:36.065 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:36:36.068 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 22:36:36.070 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 22:36:36.077 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 22:36:36.080 +01:00 [DBG] End userinfo request
2019-06-29 22:36:36.269 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 22:36:36.283 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 22:36:36.287 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 22:36:36.291 +01:00 [DBG] Rendering check session result
2019-06-29 22:36:36.567 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 22:36:36.591 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 22:36:36.601 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 22:36:36.613 +01:00 [DBG] Start discovery request
2019-06-29 22:36:36.814 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 22:36:36.816 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 22:36:36.818 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 22:36:36.820 +01:00 [DBG] Start key discovery request
2019-06-29 22:37:01.212 +01:00 [INF] Removing 0 grants
2019-06-29 22:37:31.243 +01:00 [INF] Removing 0 grants
2019-06-29 22:38:01.247 +01:00 [INF] Removing 0 grants
2019-06-29 22:38:31.264 +01:00 [INF] Removing 0 grants
2019-06-29 22:39:01.281 +01:00 [INF] Removing 0 grants
2019-06-29 22:39:31.270 +01:00 [INF] Removing 0 grants
2019-06-29 22:40:01.291 +01:00 [INF] Removing 0 grants
2019-06-29 22:40:31.311 +01:00 [INF] Removing 0 grants
2019-06-29 22:41:01.366 +01:00 [INF] Removing 0 grants
2019-06-29 22:41:31.386 +01:00 [INF] Removing 0 grants
2019-06-29 22:42:01.390 +01:00 [INF] Removing 0 grants
2019-06-29 22:42:31.395 +01:00 [INF] Removing 0 grants
2019-06-29 22:43:01.403 +01:00 [INF] Removing 0 grants
2019-06-29 22:43:31.413 +01:00 [INF] Removing 0 grants
2019-06-29 22:44:01.444 +01:00 [INF] Removing 0 grants
2019-06-29 22:44:31.459 +01:00 [INF] Removing 0 grants
2019-06-29 22:45:16.256 +01:00 [INF] Removing 0 grants
2019-06-29 22:45:46.268 +01:00 [INF] Removing 0 grants
2019-06-29 22:46:45.349 +01:00 [INF] Removing 0 grants
2019-06-29 22:47:15.465 +01:00 [INF] Removing 0 grants
2019-06-29 22:48:00.164 +01:00 [INF] Removing 0 grants
2019-06-29 22:48:30.177 +01:00 [INF] Removing 0 grants
2019-06-29 22:49:28.678 +01:00 [INF] Removing 0 grants
2019-06-29 22:49:58.687 +01:00 [INF] Removing 0 grants
2019-06-29 22:50:43.371 +01:00 [INF] Removing 0 grants
2019-06-29 22:51:13.386 +01:00 [INF] Removing 0 grants
2019-06-29 22:52:11.039 +01:00 [INF] Removing 0 grants
2019-06-29 22:52:41.063 +01:00 [INF] Removing 0 grants
2019-06-29 22:53:26.812 +01:00 [INF] Removing 0 grants
2019-06-29 22:53:56.822 +01:00 [INF] Removing 0 grants
2019-06-29 22:54:55.427 +01:00 [INF] Removing 0 grants
2019-06-29 22:55:25.433 +01:00 [INF] Removing 0 grants
2019-06-29 22:56:09.016 +01:00 [INF] Removing 0 grants
2019-06-29 22:56:39.029 +01:00 [INF] Removing 0 grants
2019-06-29 22:57:38.555 +01:00 [INF] Removing 0 grants
2019-06-29 22:58:08.572 +01:00 [INF] Removing 0 grants
2019-06-29 22:59:07.711 +01:00 [INF] Removing 0 grants
2019-06-29 22:59:37.752 +01:00 [INF] Removing 0 grants
2019-06-29 23:00:22.236 +01:00 [INF] Removing 0 grants
2019-06-29 23:00:52.238 +01:00 [INF] Removing 0 grants
2019-06-29 23:21:23.200 +01:00 [INF] Removing 0 grants
2019-06-29 23:21:53.223 +01:00 [INF] Removing 0 grants
2019-06-29 23:22:23.248 +01:00 [INF] Removing 0 grants
2019-06-29 23:22:53.251 +01:00 [INF] Removing 0 grants
2019-06-29 23:23:23.253 +01:00 [INF] Removing 0 grants
2019-06-29 23:23:53.270 +01:00 [INF] Removing 0 grants
2019-06-29 23:27:38.192 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 23:27:38.241 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 23:27:38.242 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 23:27:38.243 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 23:27:38.243 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 23:27:38.244 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 23:27:38.489 +01:00 [DBG] Starting grant removal
2019-06-29 23:27:40.171 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 23:27:40.174 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 23:27:40.176 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 23:27:40.176 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 23:27:40.177 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 23:27:40.181 +01:00 [DBG] Error Url: /home/error
2019-06-29 23:27:40.182 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 23:28:07.522 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:28:07.532 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:28:07.534 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:28:07.540 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:28:07.556 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:28:07.558 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:28:07.565 +01:00 [DBG] Start discovery request
2019-06-29 23:28:07.746 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 23:28:07.770 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 23:28:07.771 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 23:28:07.776 +01:00 [DBG] Start authorize request
2019-06-29 23:28:07.806 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 23:28:07.817 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 23:28:07.844 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:28:07.936 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 23:28:07.987 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"d12f7661d1ae48b6835c2269caa0a6fb","UiLocales":null,"Nonce":"77fa1fb979b044f7af24c1dd6418ad65","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"99ff52ec6887c7540542fcac11062dd8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"d12f7661d1ae48b6835c2269caa0a6fb","nonce":"77fa1fb979b044f7af24c1dd6418ad65"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 23:28:08.558 +01:00 [INF] Removing 0 grants
2019-06-29 23:28:09.052 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 23:28:09.081 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 23:28:09.222 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 23:28:09.287 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 23:28:09.300 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 23:28:09.360 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 23:28:09.678 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 23:28:09.681 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 23:28:09.710 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"d12f7661d1ae48b6835c2269caa0a6fb","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 23:28:12.143 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:28:12.215 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:28:12.332 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:28:12.336 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:28:12.342 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:28:12.513 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:28:12.568 +01:00 [DBG] Start discovery request
2019-06-29 23:28:12.647 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 23:28:12.657 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:28:12.662 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:28:12.664 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 23:28:12.667 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 23:28:12.669 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 23:28:12.774 +01:00 [DBG] Start key discovery request
2019-06-29 23:28:13.340 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 23:28:13.504 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:28:13.573 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:28:13.702 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 23:28:13.716 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:28:13.723 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:28:13.725 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 23:28:13.799 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 23:28:13.808 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 23:28:13.833 +01:00 [DBG] Start userinfo request
2019-06-29 23:28:13.846 +01:00 [DBG] Bearer token found in header
2019-06-29 23:28:14.096 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:28:14.104 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:28:14.132 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 23:28:14.139 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561847289,"exp":1561850889,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561843099,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 23:28:14.169 +01:00 [DBG] Creating userinfo response
2019-06-29 23:28:14.176 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:28:14.225 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:28:14.260 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 23:28:14.273 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:28:14.314 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 23:28:14.323 +01:00 [DBG] End userinfo request
2019-06-29 23:28:14.417 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 23:28:14.424 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 23:28:14.427 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 23:28:14.435 +01:00 [DBG] Rendering check session result
2019-06-29 23:28:16.353 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:28:16.388 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:28:16.457 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:28:16.628 +01:00 [DBG] Start discovery request
2019-06-29 23:28:17.103 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 23:28:17.105 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 23:28:17.107 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 23:28:17.108 +01:00 [DBG] Start key discovery request
2019-06-29 23:28:38.634 +01:00 [INF] Removing 0 grants
2019-06-29 23:29:08.656 +01:00 [INF] Removing 0 grants
2019-06-29 23:29:16.812 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-06-29 23:29:16.882 +01:00 [DBG] Client list checked and origin: https://jwt.io is not allowed
2019-06-29 23:29:16.904 +01:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-06-29 23:29:16.967 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:29:17.000 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:29:17.007 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:29:17.010 +01:00 [DBG] Start discovery request
2019-06-29 23:29:38.694 +01:00 [INF] Removing 0 grants
2019-06-29 23:30:08.708 +01:00 [INF] Removing 0 grants
2019-06-29 23:30:38.720 +01:00 [INF] Removing 0 grants
2019-06-29 23:31:08.714 +01:00 [INF] Removing 0 grants
2019-06-29 23:31:38.734 +01:00 [INF] Removing 0 grants
2019-06-29 23:32:08.737 +01:00 [INF] Removing 0 grants
2019-06-29 23:32:38.751 +01:00 [INF] Removing 0 grants
2019-06-29 23:33:08.758 +01:00 [INF] Removing 0 grants
2019-06-29 23:33:38.791 +01:00 [INF] Removing 0 grants
2019-06-29 23:33:57.204 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:33:57.213 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:33:57.219 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:33:57.257 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:33:57.303 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:33:57.314 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:33:57.323 +01:00 [DBG] Start discovery request
2019-06-29 23:33:57.513 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 23:33:57.551 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 23:33:57.659 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 23:33:57.680 +01:00 [DBG] Rendering check session result
2019-06-29 23:34:08.806 +01:00 [INF] Removing 0 grants
2019-06-29 23:34:38.811 +01:00 [INF] Removing 0 grants
2019-06-29 23:35:08.836 +01:00 [INF] Removing 0 grants
2019-06-29 23:35:38.848 +01:00 [INF] Removing 0 grants
2019-06-29 23:36:08.862 +01:00 [INF] Removing 0 grants
2019-06-29 23:36:38.811 +01:00 [INF] Removing 0 grants
2019-06-29 23:37:08.768 +01:00 [INF] Removing 0 grants
2019-06-29 23:37:38.729 +01:00 [INF] Removing 0 grants
2019-06-29 23:38:08.721 +01:00 [INF] Removing 0 grants
2019-06-29 23:38:38.721 +01:00 [INF] Removing 0 grants
2019-06-29 23:45:01.096 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 23:45:01.159 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 23:45:01.160 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 23:45:01.160 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 23:45:01.161 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 23:45:01.161 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 23:45:01.429 +01:00 [DBG] Starting grant removal
2019-06-29 23:45:03.469 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 23:45:03.527 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 23:45:03.542 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 23:45:03.550 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 23:45:03.551 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 23:45:03.552 +01:00 [DBG] Error Url: /home/error
2019-06-29 23:45:03.553 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 23:47:21.745 +01:00 [INF] Removing 0 grants
2019-06-29 23:49:10.461 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-29 23:49:10.525 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-29 23:49:10.526 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-29 23:49:10.526 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-29 23:49:10.527 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-29 23:49:10.527 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-29 23:49:10.898 +01:00 [DBG] Starting grant removal
2019-06-29 23:49:13.158 +01:00 [DBG] Login Url: /Account/Login
2019-06-29 23:49:13.171 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-29 23:49:13.201 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-29 23:49:13.212 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-29 23:49:13.214 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-29 23:49:13.218 +01:00 [DBG] Error Url: /home/error
2019-06-29 23:49:13.271 +01:00 [DBG] Error Id Parameter: errorId
2019-06-29 23:49:40.995 +01:00 [INF] Removing 0 grants
2019-06-29 23:50:11.022 +01:00 [INF] Removing 0 grants
2019-06-29 23:50:32.022 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:50:32.100 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:50:32.139 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:50:32.166 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:50:32.234 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:50:32.237 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:50:32.242 +01:00 [DBG] Start discovery request
2019-06-29 23:50:32.613 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 23:50:32.623 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 23:50:32.641 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 23:50:32.650 +01:00 [DBG] Start authorize request
2019-06-29 23:50:32.681 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 23:50:32.692 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 23:50:32.749 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:50:33.032 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 23:50:33.109 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"cf6a8525da2041b0a480ee44e2ac286a","UiLocales":null,"Nonce":"717078ec95ab4ee38c33555b9ed709c1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"99ff52ec6887c7540542fcac11062dd8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"cf6a8525da2041b0a480ee44e2ac286a","nonce":"717078ec95ab4ee38c33555b9ed709c1"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 23:50:34.636 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 23:50:34.682 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 23:50:34.754 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 23:50:34.886 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 23:50:34.908 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 23:50:35.935 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 23:50:36.590 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 23:50:36.622 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 23:50:36.729 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"cf6a8525da2041b0a480ee44e2ac286a","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 23:50:39.905 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:50:40.041 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:50:40.193 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:50:40.271 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:50:40.468 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:50:40.682 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:50:40.795 +01:00 [DBG] Start discovery request
2019-06-29 23:50:41.411 +01:00 [INF] Removing 0 grants
2019-06-29 23:50:41.412 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 23:50:41.543 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:50:41.582 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:50:41.628 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 23:50:41.654 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 23:50:41.659 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 23:50:41.755 +01:00 [DBG] Start key discovery request
2019-06-29 23:50:42.196 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 23:50:42.219 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:50:42.222 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:50:42.282 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 23:50:42.288 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:50:42.305 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:50:42.308 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 23:50:42.322 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 23:50:42.329 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 23:50:42.361 +01:00 [DBG] Start userinfo request
2019-06-29 23:50:42.383 +01:00 [DBG] Bearer token found in header
2019-06-29 23:50:42.725 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:50:42.818 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:50:42.925 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 23:50:42.954 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561848636,"exp":1561852236,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561843099,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 23:50:43.010 +01:00 [DBG] Creating userinfo response
2019-06-29 23:50:43.029 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:50:43.035 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:50:43.059 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 23:50:43.066 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:50:43.085 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 23:50:43.091 +01:00 [DBG] End userinfo request
2019-06-29 23:50:43.163 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 23:50:43.285 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 23:50:43.319 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 23:50:43.442 +01:00 [DBG] Rendering check session result
2019-06-29 23:50:44.562 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:50:44.680 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:50:44.731 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:50:44.735 +01:00 [DBG] Start discovery request
2019-06-29 23:50:45.210 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 23:50:45.231 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 23:50:45.274 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 23:50:45.279 +01:00 [DBG] Start key discovery request
2019-06-29 23:51:11.534 +01:00 [INF] Removing 0 grants
2019-06-29 23:51:41.540 +01:00 [INF] Removing 0 grants
2019-06-29 23:51:58.755 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:51:58.972 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:51:59.501 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:51:59.601 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:51:59.733 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:51:59.920 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:52:00.115 +01:00 [DBG] Start discovery request
2019-06-29 23:52:00.352 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 23:52:00.375 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 23:52:00.389 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 23:52:00.396 +01:00 [DBG] Rendering check session result
2019-06-29 23:52:05.481 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:52:06.337 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:52:06.421 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:52:06.447 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:52:06.645 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:52:07.403 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:52:07.519 +01:00 [DBG] Start discovery request
2019-06-29 23:52:07.577 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:52:07.642 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 23:52:07.694 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:52:07.698 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 23:52:07.701 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 23:52:07.704 +01:00 [DBG] Rendering check session result
2019-06-29 23:52:07.707 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:52:07.710 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:52:07.716 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:52:07.720 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:52:07.722 +01:00 [DBG] Start discovery request
2019-06-29 23:52:07.770 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 23:52:07.776 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 23:52:07.822 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 23:52:07.836 +01:00 [DBG] Start authorize request
2019-06-29 23:52:07.840 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 23:52:07.847 +01:00 [DBG] Start authorize request protocol validation
2019-06-29 23:52:07.864 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:52:07.867 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 23:52:07.890 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"1810a514b14944b8a6e86dc7935aba60","UiLocales":null,"Nonce":"d04fa4b4fe8747c0abeff4e6117fe558","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"99ff52ec6887c7540542fcac11062dd8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"1810a514b14944b8a6e86dc7935aba60","nonce":"d04fa4b4fe8747c0abeff4e6117fe558"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 23:52:08.607 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-29 23:52:08.654 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-29 23:52:08.659 +01:00 [DBG] Creating Implicit Flow response.
2019-06-29 23:52:08.661 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-29 23:52:08.662 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-29 23:53:34.041 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-29 23:53:34.090 +01:00 [INF] Removing 0 grants
2019-06-29 23:53:34.152 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-29 23:53:34.173 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-29 23:53:34.180 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"1810a514b14944b8a6e86dc7935aba60","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-29 23:53:38.769 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:53:38.908 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:53:38.987 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:53:39.056 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:53:39.089 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:53:39.105 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:53:39.111 +01:00 [DBG] Start discovery request
2019-06-29 23:53:39.136 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-29 23:53:39.151 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:53:39.164 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:53:39.244 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-29 23:53:39.402 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-29 23:53:39.467 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-29 23:53:39.697 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-29 23:53:39.802 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-29 23:53:39.931 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-29 23:53:39.938 +01:00 [DBG] Start discovery request
2019-06-29 23:53:39.940 +01:00 [DBG] Rendering check session result
2019-06-29 23:53:40.346 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-29 23:53:40.368 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:53:40.372 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:53:40.375 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-29 23:53:40.387 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-29 23:53:40.394 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-29 23:53:40.405 +01:00 [DBG] Start key discovery request
2019-06-29 23:53:40.454 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 23:53:40.462 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:53:40.466 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:53:40.490 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-29 23:53:40.496 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-29 23:53:40.498 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-29 23:53:40.509 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-29 23:53:40.561 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-29 23:53:40.656 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-29 23:53:40.691 +01:00 [DBG] Start userinfo request
2019-06-29 23:53:40.717 +01:00 [DBG] Bearer token found in header
2019-06-29 23:53:40.731 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:53:40.743 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-29 23:53:41.168 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-29 23:53:41.252 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561848814,"exp":1561852414,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561843099,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-29 23:53:41.279 +01:00 [DBG] Creating userinfo response
2019-06-29 23:53:41.280 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:53:41.282 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:53:41.284 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-29 23:53:41.286 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-29 23:53:44.823 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-29 23:53:44.837 +01:00 [DBG] End userinfo request
2019-06-29 23:54:04.189 +01:00 [INF] Removing 0 grants
2019-06-29 23:54:34.202 +01:00 [INF] Removing 0 grants
2019-06-29 23:55:04.210 +01:00 [INF] Removing 0 grants
2019-06-29 23:55:34.223 +01:00 [INF] Removing 0 grants
2019-06-29 23:56:04.226 +01:00 [INF] Removing 0 grants
2019-06-29 23:56:34.254 +01:00 [INF] Removing 0 grants
2019-06-29 23:57:04.304 +01:00 [INF] Removing 0 grants
2019-06-29 23:57:34.326 +01:00 [INF] Removing 0 grants
2019-06-29 23:58:04.336 +01:00 [INF] Removing 0 grants
2019-06-29 23:58:34.359 +01:00 [INF] Removing 0 grants
2019-06-29 23:59:04.360 +01:00 [INF] Removing 0 grants
2019-06-29 23:59:34.372 +01:00 [INF] Removing 0 grants
2019-06-30 00:00:04.375 +01:00 [INF] Removing 0 grants
2019-06-30 00:00:34.394 +01:00 [INF] Removing 0 grants
2019-06-30 00:01:04.404 +01:00 [INF] Removing 0 grants
2019-06-30 00:01:34.443 +01:00 [INF] Removing 0 grants
2019-06-30 00:02:04.463 +01:00 [INF] Removing 0 grants
2019-06-30 00:02:34.479 +01:00 [INF] Removing 0 grants
2019-06-30 00:03:04.479 +01:00 [INF] Removing 0 grants
2019-06-30 00:03:34.492 +01:00 [INF] Removing 0 grants
2019-06-30 00:04:04.497 +01:00 [INF] Removing 0 grants
2019-06-30 00:04:34.525 +01:00 [INF] Removing 0 grants
2019-06-30 00:05:53.621 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-30 00:05:53.688 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-30 00:05:53.689 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-30 00:05:53.689 +01:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-30 00:05:53.690 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-30 00:05:53.690 +01:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-30 00:05:53.869 +01:00 [DBG] Starting grant removal
2019-06-30 00:05:54.902 +01:00 [DBG] Login Url: /Account/Login
2019-06-30 00:05:54.908 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-30 00:05:54.909 +01:00 [DBG] Logout Url: /Account/Logout
2019-06-30 00:05:54.916 +01:00 [DBG] ConsentUrl Url: /consent
2019-06-30 00:05:54.924 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-30 00:05:54.928 +01:00 [DBG] Error Url: /home/error
2019-06-30 00:05:54.929 +01:00 [DBG] Error Id Parameter: errorId
2019-06-30 00:06:24.032 +01:00 [INF] Removing 0 grants
2019-06-30 00:06:39.392 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-30 00:06:39.407 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-30 00:06:39.414 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-30 00:06:39.421 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-30 00:06:39.435 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-30 00:06:39.437 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-30 00:06:39.446 +01:00 [DBG] Start discovery request
2019-06-30 00:06:39.575 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-30 00:06:39.596 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-30 00:06:39.609 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-30 00:06:39.647 +01:00 [DBG] Start authorize request
2019-06-30 00:06:39.706 +01:00 [DBG] User in authorize request: eb81adad-cde8-490d-972d-242c5668e094
2019-06-30 00:06:39.737 +01:00 [DBG] Start authorize request protocol validation
2019-06-30 00:06:39.795 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-30 00:06:39.921 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-30 00:06:39.960 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"AngularClientApp","ClientName":"Angular SPA Client","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email userrole api.read","State":"55d00f5498f6467e875a122accd132ce","UiLocales":null,"Nonce":"a73033259132478f8c95629f56bce7e0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"99ff52ec6887c7540542fcac11062dd8","Raw":{"client_id":"AngularClientApp","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email userrole api.read","state":"55d00f5498f6467e875a122accd132ce","nonce":"a73033259132478f8c95629f56bce7e0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-30 00:06:40.502 +01:00 [DBG] LSscCENH9sLMFdQOI5G4WwNSfsRq/5dNixRvrJGqDQM= found in database: true
2019-06-30 00:06:40.520 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-30 00:06:40.552 +01:00 [DBG] Creating Implicit Flow response.
2019-06-30 00:06:40.579 +01:00 [DBG] Getting claims for access token for client: AngularClientApp
2019-06-30 00:06:40.586 +01:00 [DBG] Getting claims for access token for subject: eb81adad-cde8-490d-972d-242c5668e094
2019-06-30 00:06:54.073 +01:00 [INF] Removing 0 grants
2019-06-30 00:06:54.073 +01:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-30 00:06:55.509 +01:00 [DBG] Getting claims for identity token for subject: eb81adad-cde8-490d-972d-242c5668e094 and client: AngularClientApp
2019-06-30 00:06:55.542 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-30 00:06:55.627 +01:00 [INF] Authorize endpoint response
{"SubjectId":"eb81adad-cde8-490d-972d-242c5668e094","ClientId":"AngularClientApp","RedirectUri":"http://localhost:4200/auth-callback","State":"55d00f5498f6467e875a122accd132ce","Scope":"openid profile email userrole api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-30 00:06:57.494 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-06-30 00:06:57.560 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-30 00:06:57.599 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-30 00:06:57.604 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-30 00:06:57.621 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-30 00:06:57.686 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-30 00:06:57.816 +01:00 [DBG] Start discovery request
2019-06-30 00:06:58.153 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-06-30 00:06:58.282 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-30 00:06:58.355 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-30 00:06:58.384 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-30 00:06:58.431 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-30 00:06:58.507 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-30 00:06:58.526 +01:00 [DBG] Start key discovery request
2019-06-30 00:06:58.640 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-30 00:06:58.648 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-30 00:06:58.649 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-30 00:06:58.668 +01:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-06-30 00:06:58.670 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-06-30 00:06:58.673 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-06-30 00:06:58.682 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-30 00:06:58.693 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-30 00:06:58.705 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-30 00:06:58.718 +01:00 [DBG] Start userinfo request
2019-06-30 00:06:58.722 +01:00 [DBG] Bearer token found in header
2019-06-30 00:06:58.803 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-30 00:06:58.836 +01:00 [DBG] client configuration validation for client AngularClientApp succeeded.
2019-06-30 00:06:58.858 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-30 00:06:58.864 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561849614,"exp":1561853214,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourcesapi"],"client_id":"AngularClientApp","sub":"eb81adad-cde8-490d-972d-242c5668e094","auth_time":1561843099,"idp":"local","name":"Bob Smith","given_name":"Bob","family_name":"Smith","email":"BobSmith@email.com","email_verified":"true","website":"http://bob.com","address":"{ 'street_address': 'One Hacker Way', 'locality': 'Heidelberg', 'postal_code': 69118, 'country': 'Germany' }","location":"somewhere","role":"consumer","scope":["openid","profile","email","userrole","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-30 00:06:58.891 +01:00 [DBG] Creating userinfo response
2019-06-30 00:06:58.897 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-30 00:06:58.901 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-30 00:06:58.931 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified role
2019-06-30 00:06:58.969 +01:00 [DBG] Scopes in access token: openid profile email userrole api.read
2019-06-30 00:06:59.028 +01:00 [INF] Profile service returned the following claim types: sub name given_name family_name email email_verified website address location role
2019-06-30 00:06:59.048 +01:00 [DBG] End userinfo request
2019-06-30 00:06:59.141 +01:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-30 00:06:59.321 +01:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-30 00:06:59.386 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-30 00:06:59.447 +01:00 [DBG] Rendering check session result
2019-06-30 00:07:00.643 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-30 00:07:00.741 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-30 00:07:00.767 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-30 00:07:00.778 +01:00 [DBG] Start discovery request
2019-06-30 00:07:01.080 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-30 00:07:01.086 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-30 00:07:01.160 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-30 00:07:01.162 +01:00 [DBG] Start key discovery request
2019-06-30 00:07:24.078 +01:00 [INF] Removing 0 grants
2019-06-30 00:07:54.100 +01:00 [INF] Removing 0 grants
2019-06-30 00:08:24.100 +01:00 [INF] Removing 0 grants
